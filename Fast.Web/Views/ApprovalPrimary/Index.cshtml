@model Fast.Web.Models.LPH.LPHApprovalsModel
@using Newtonsoft.Json;
@using Fast.Web.Resources;
@{
    ViewBag.Title = "Index";
}

@section CSS_lib{
    <!-- Specific Page Vendor CSS -->
    <link href="~/Content/dashforge/lib/typicons.font/typicons.css" rel="stylesheet">
    <link href="~/Content/dashforge/lib/prismjs/themes/prism-vs.css" rel="stylesheet">
    <link href="~/Content/dashforge/lib/datatables.net-dt/css/jquery.dataTables.min.css" rel="stylesheet">
    <link href="~/Content/dashforge/lib/datatables.net-responsive-dt/css/responsive.dataTables.min.css" rel="stylesheet">
    <link href="~/Content/dashforge/assets/css/dashforge.demo.css" rel="stylesheet" />
    <link href="~/Content/dashforge/lib/select2/css/select2.min.css" rel="stylesheet">
}

<div class="content content-fixed bd-b">
    <div class="container-fluid pd-x-0 pd-lg-x-10 pd-xl-x-0">
        <div class="d-sm-flex align-items-center justify-content-between">
            <div>
                <h4 class="mg-b-5">Approval List</h4>
                <p class="mg-b-0 tx-color-03">Approval Data Management</p>
            </div>
            <div class="d-none d-md-block tx-right">
                <button class="btn btn-outline-secondary btn-sm pd-x-15 mg-r-0-f btn-uppercase dtAddButton" onclick="GenerateExcel()">
                    <span><i class="fa fa-lg fa-file-excel"></i> EXCEL</span>
                </button>
                <div id="buttonprint" class="dtButton d-inline-block mg-r-2-f"></div>
            </div>
        </div><!-- End content header -->
        <br />
        <div data-label="Filter" class="df-example demo-table dtMarginTop">
            <div class="row">
                <div class="col-sm-1">
                    <label class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-t-10 tx-color-03">@UIResources.Date</label>
                </div>
                <div class="col-md-2 pd-l-0">
                    <input class="form-control datepicker" id="flDate" type="text" />
                </div>
                <div class="col-sm-1">
                    <label class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-t-10 tx-color-03">@UIResources.Shift</label>
                </div>
                <div class="col-sm-2 pd-l-0">
                    <input id="shift" class="form-control" type="text" />
                </div>
                <div class="col-sm-1">
                    <label class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-t-10 tx-color-03">LPH Type</label>
                </div>
                <div class="col-sm-2 pd-l-0">
                    @Html.DropDownListFor(x => x.LPHType, (IEnumerable<SelectListItem>)ViewBag.LPHTypeList, "- Please Select -", new { @class = "form-control", @id = "lphtype" })
                </div>
                <div class="col-sm-1">
                    <label class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-t-10 tx-color-03">Status LPH</label>
                </div>
                <div class="col-sm-2 pd-l-0 pd-r-0">
                    <select class="form-control" id="status" name="status">
                        <option value="">Waiting for Approval</option>
                        <option value="all">All Status</option>
                        <option value="approved">Approved</option>
                    </select>
                </div>

                <div class="col-sm-1 mg-t-20">
                    <label class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-t-10 tx-color-03">List Data</label>
                </div>
                <div class="col-sm-2 mg-t-20 pd-l-0">
                    <select id="select_source" class="form-control">
                        <option value="">Show My Approval</option>
                        <option value="MyLocat">Show Approval in My Location</option>
                        <option value="GetAll">Show All Approval</option>
                        <option value="Location">Show Approval by Filter Location</option>
                    </select>
                </div>

                <div class="col-sm-7 mg-t-20">
                    <div class="row" id="location_detail" style="display:none">
                        <div class="col-4 pd-l-5 d-inline-block"><select id="Location1" name="Location1" class="form-control selection-location"></select></div>
                        <div class="col-4 pd-l-5 d-inline-block"><select id="Location2" name="Location2" class="form-control selection-department"></select></div>
                        <div class="col-4 pd-l-5 d-inline-block"><select id="Location3" name="Location3" class="form-control selection-subdepartment"></select></div>
                    </div>
                </div>

                <button id="btnSearch" class="btn pd-x-15 btn-primary btn-uppercase btn-block col-sm-2 mg-t-20">Search</button>

            </div>
        </div>
        <div data-label="History Data" class="df-example demo-table dtMarginTop">
            <table class="table table-bordered table-striped mb-none border-bottom-0 table-fast" id="approvalTable">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>@UIResources.Date</th>
                        <th>@UIResources.Shift</th>
                        <th>LPH Type</th>
                        <th>User</th>
                        <th>@UIResources.Status</th>
                        <th>Last Update</th>
                        <th>Action</th>
                    </tr>
                </thead>
            </table>
        </div>
    </div>
</div>
<div id="jsonLocationTree" data-json='@Html.Raw(JsonConvert.SerializeObject(ViewBag.LocationTree))' />

@section Scripts{
    <script src="~/Content/dashforge/lib/prismjs/prism.js"></script>
    <script src="~/Content/dashforge/lib/moment/min/moment-with-locales.min.js"></script>
    <script src="~/Content/dashforge/lib/datatables.net/js/jquery.dataTables.min.js"></script>
    <script src="~/Content/dashforge/lib/datatables.net-dt/js/dataTables.dataTables.min.js"></script>
    <script src="~/Content/dashforge/lib/datatables.net-responsive/js/dataTables.responsive.min.js"></script>
    <script src="~/Content/dashforge/lib/datatables.net-responsive-dt/js/responsive.dataTables.min.js"></script>
    <script src="~/Content/theme/lib/datatable-export/dataTables.buttons.min.js"></script>
    <script src="~/Content/theme/lib/datatable-export/buttons.flash.min.js"></script>
    <script src="~/Content/theme/lib/datatable-export/buttons.html5.min.js"></script>
    <script src="~/Content/theme/lib/datatable-export/buttons.print.min.js"></script>
    <script src="~/Content/theme/lib/datatable-export/jszip.min.js"></script>
    <script src="~/Content/theme/lib/datatable-export/pdfmake.min.js"></script>
    <script src="~/Content/theme/lib/datatable-export/vfs_fonts.js"></script>
    <script src="~/Content/theme/lib/datatable-export/exportaction.js"></script>

    <script src="~/Content/dashforge/lib/select2/js/select2.min.js"></script>

    <script type="text/javascript">
        var Approve = function (ID, LPHSUBID) {
            $.ajax({
			    url: fastApp.BaseUrl + '/ApprovalPrimary/GetPPLPHDetailBySUBSID?subsID=' + LPHSUBID,
			    type: 'POST',
			    success: function (result) {
                    var lphid = result.Result.ID; // ---> LPH ID
                    var resType = result.Result.LPHType;
                    window.location.href = fastApp.BaseUrl  +'/'+ resType + '/Approval?lphid=' + lphid;
			    }
		    });
        }
        var Submitted = function (ID, LPHSUBID) {
            $.ajax({
			    url: fastApp.BaseUrl + '/ApprovalPrimary/GetPPLPHDetailBySUBSID?subsID=' + LPHSUBID,
			    type: 'POST',
			    success: function (result) {
                    var lphid = result.Result.ID; // ---> LPH ID
                    var resType = result.Result.LPHType;
                    window.location.href = fastApp.BaseUrl  +'/'+ resType + '/Submitted?lphid=' + lphid + '&type=0';
			    }
		    });
        }

        $(document).ready(function () {
            $('#select_source').change(function () {
                if ($(this).val() == "Location") {
                    $('#location_detail').show();
                } else {
                    $('#location_detail').hide();
                    //$('#btnSearch').trigger('click');
                }
            })

            $('#Location1,#Location2,#Location3').change(function () {
                //$('#btnSearch').trigger('click');
            })

            $('.datepicker').datepicker({
                format: 'd-M-yy',
                //language: 'id-ID'
			});

            var table = $('#approvalTable').dataTable({
				"autoWidth": false,
				"processing": true,
				"serverSide": true,
				"filter": true,
				"orderMulti": false,
                "pageLength": 25,
                "destroy": true,
                "order": [[ 6, "desc" ]],
				"ajax": {
					"url": fastApp.BaseUrl + "/ApprovalPrimary/GetData",
					"type": "POST",
					"datatype": "json"
                },
                "drawCallback": function (settings) {
                    $('#loading_overlay').addClass('d-none');
                },
				"columnDefs":
					[{
						"targets": [0],
                        "searchable": true,
						"orderable": true
					},
					{
						"targets": [1],
						"searchable": true,
                        "orderable": true,
					},
					{
						"targets": [2],
						"searchable": true,
						"orderable": true
					},
					{
						"targets": [3],
						"searchable": true,
						"orderable": true
					},
					{
						"targets": [4],
						"searchable": true,
						"orderable": true
					},
					{
						"targets": [5],
						"searchable": true,
						"orderable": true
					},
					{
						"targets": [6],
						"searchable": true,
						"orderable": true
					},
					{
						"targets": [7],
						"searchable": true,
						"orderable": true
					},
					],

				"columns": [
                    { "data": "LPHSubmissionID", "name": "LPHSubmissionID", "title": "ID", "autoWidth": false },
                    {
						"data": "Date",
						render: function (data, type, row) {
							if (data)
								return moment(data).format("DD-MMM-YY");
							else
								return '';
						}
                    },
					{ "data": "Shift", "name": "Shift", "autoWidth": true },
                    { "data": "LPHType", "name": "LPHType", "title": "LPH Type", "autoWidth": true,
                        render: function (data, type, row) {
                            console.log("---" + data + "---");
                            if (data == "LPHPrimaryKretekLineAddback")
                                return "Kretek Line - Addback";
                            else if (data == "LPHPrimaryDiet")
                                 return "Intermediate Line - DIET";
                            else if (data == "LPHPrimaryCloveInfeedConditioning")
                                 return "Intermediate Line - Clove Feeding & DCCC";
                            else if (data == "LPHPrimaryCSFCutDryPacking")
                                return "Intermediate Line - CSF Cut Dry & Packing";
                            else if (data == "LPHPrimaryCSFInfeedConditioning")
                                return "Intermediate Line - CSF Feeding & DCCC";
                            else if (data == "LPHPrimaryCloveCutDryPacking")
                                return "Intermediate Line - Clove Cut Dry & Packing";
                            else if (data == "LPHPrimaryRTC")
                                return "Intermediate Line - RTC";
                            else if (data == "LPHPrimaryKitchen")
                                return "Intermediate Line - Casing Kitchen";
                            else if (data == "LPHPrimaryWhiteLineOTP")
                                return "White Line OTP - Process Note";
                            else if (data == "LPHPrimaryKretekLineFeeding")
                                return "Kretek Line - Feeding KR & RJ";
                            else if (data == "LPHPrimaryKretekLineConditioning")
                                return "Kretek Line - DCCC KR & RJ";
                            else if (data == "LPHPrimaryKretekLineCuttingDrying")
                                return "Kretek Line - Cut Dry";
                            else if (data == "LPHPrimaryKretekLinePacking")
                                return "Kretek Line - Packing";
                            else if (data == "LPHPrimaryCresFeedingConditioning")
                                return "Kretek Line - CRES Feeding & DCCC";
                            else if (data == "LPHPrimaryCresDryingPacking")
                                return "Kretek Line - CRES Cut Dry & Packing";
                            else if (data == "LPHPrimaryWhiteLineFeedingWhite")
                                return "White Line PMID - Feeding White";
                            else if (data == "LPHPrimaryWhiteLineDCCC")
                                return "White Line PMID - DCCC";
                            else if (data == "LPHPrimaryWhiteLineCuttingFTD")
                                return "White Line PMID - Cutting + FTD";
                            else if (data == "LPHPrimaryWhiteLineAddback")
                                return "White Line PMID - Addback";
                            else if (data == "LPHPrimaryWhiteLinePackingWhite")
                                return "White Line PMID - Packing White";
                            else if (data == "LPHPrimaryWhiteLineFeedingSPM")
                                return "White Line PMID - Feeding SPM";
                            else if (data == "LPHPrimaryISWhiteFeeding")
                                return "White Line PMID - Feeding IS White";
                            else if (data == "LPHPrimaryISWhiteCutDry")
                                return "White Line PMID - Cut Dry IS White";
                            else
								return data;
                        }
                    },
                    { "data": "User", "name": "User", "title": "User", "autoWidth": false },
                    {
                        "data": "Status", "name": "Status", "title": "Status", "autoWidth": false
      //                  ,
						//render: function (data, type, full, meta) {
						//	if (full['IsNeedMyApproval']) {
						//		return 'Waiting for Approval';
      //                      } else {
						//		return 'Approved';
						//	}
						//}
                    },
					{
                        "data": "ModifiedDate", "name": "ModifiedDate", "title": "Last Update", "autoWidth": false,
                        render: function (data, type, row) {
							if (data)
								return moment(data).format("DD-MMM-YY hh:mm");
							else
								return '';
                        }
                    },
				    {
						"render": function (data, type, full, meta) {
							if (full['IsNeedMyApproval']) {
								//return '<button class="btn-menu btn-default" onclick="Approve(\'' + full['ID'] + '\',\'' + full['LPHSUBID'] + '\')" data-toggle="modal" data-target="#ApproveModal" title="Approve"><i class="fa fa-check"></i></button>';
                                return '<button class="btn-menu btn-default" onclick="Approve(\'' + full['ID'] + '\',\'' + full['LPHSubmissionID'] + '\') "title="Approve"><i class="fa fa-check"></i></button>';
                            } else {
                                return '<button class="btn-menu btn-default" onclick="Submitted(\'' + full['ID'] + '\',\'' + full['LPHSubmissionID'] + '\') "title="See Submission"><i class="fa fa-eye"></i></button>';
                                //return '-';
							}
						}
					}
				]
			});

            var LocationTree = JSON.parse($("#jsonLocationTree").attr("data-json"));

            console.log(LocationTree);

            var select_locat = $('select.selection-location');
            select_locat.append('<option label="Choose "></option>');

            for (var i = 0; i < LocationTree.ProductionCenters.length; i++) {
                select_locat.append('<option value='+LocationTree.ProductionCenters[i].LocationID+'>' + LocationTree.ProductionCenters[i].Description + '</option>')
            }

            $('.selection-location').select2({
                width: "100%",
              placeholder: 'Select Location',
              searchInputPlaceholder: 'Search options'
            });

            $('.selection-department, .selection-subdepartment').select2({width: "100%"});

            var locat_selected;
            $(document).on("change",".selection-location",function(){
                locat_selected = $(this).select2("val");
                console.log(locat_selected);

                $('.selection-department').select2('destroy');
                $('.selection-subdepartment').select2('destroy');
                $('.selection-department').empty();
                $('.selection-subdepartment').empty();

                var select_depart = $('select.selection-department');
                select_depart.append('<option label="Choose "></option>');

                for (var i = 0; i < LocationTree.ProductionCenters.length; i++) {
                    if ($.inArray(LocationTree.ProductionCenters[i].LocationID.toString(), locat_selected) >= 0) {
                        select_depart.append('<optgroup label="'+LocationTree.ProductionCenters[i].Description+'">')
                        for (var j = 0; j < LocationTree.ProductionCenters[i].Departments.length; j++) {
                            select_depart.append('<option value='+LocationTree.ProductionCenters[i].Departments[j].LocationID +'>' + LocationTree.ProductionCenters[i].Code+"-"+LocationTree.ProductionCenters[i].Departments[j].Description + '</option>')
                        }
                        select_depart.append('</optgroup>')
                    }
                }

                $('.selection-department').select2({
                    width: "100%",
                  placeholder: 'Select Department',
                  searchInputPlaceholder: 'Search options'
                });
                $('.selection-subdepartment').select2();
            });

            $(document).on("change",".selection-department",function(){
                var department_selected = $(this).select2("val");
                console.log(department_selected);

                $('.selection-subdepartment').select2('destroy');
                $('.selection-subdepartment').empty();

                var select_subdepart = $('select.selection-subdepartment');
                select_subdepart.append('<option label="Choose "></option>');

                for (var i = 0; i < LocationTree.ProductionCenters.length; i++) {
                    if ($.inArray(LocationTree.ProductionCenters[i].LocationID.toString(), locat_selected) >= 0) {
                        for (var j = 0; j < LocationTree.ProductionCenters[i].Departments.length; j++) {
                            if ($.inArray(LocationTree.ProductionCenters[i].Departments[j].LocationID.toString(), department_selected) >= 0) {
                                select_subdepart.append('<optgroup label="' + LocationTree.ProductionCenters[i].Description+ " - " + LocationTree.ProductionCenters[i].Departments[j].Description + '">')
                                for (var k = 0; k < LocationTree.ProductionCenters[i].Departments[j].SubDepartments.length; k++) {
                                    select_subdepart.append('<option value='+LocationTree.ProductionCenters[i].Departments[j].SubDepartments[k].LocationID +'>' + LocationTree.ProductionCenters[i].Code+"-"+LocationTree.ProductionCenters[i].Departments[j].Code+"-"+LocationTree.ProductionCenters[i].Departments[j].SubDepartments[k].Description + '</option>')
                                }
                                select_subdepart.append('</optgroup>')
                            }
                        }
                    }
                }

                $('.selection-subdepartment').select2({
                    width: "100%",
                  placeholder: 'Select Sub Department',
                  searchInputPlaceholder: 'Search options'
                });
            });
        });

        $('#btnSearch').on('click', function () {
            $('#loading_overlay').removeClass('d-none');
            var dateFilter = $('#flDate').val();
            var shiftFilter = $('#shift').val() != "" ? $('#shift').val() : "";
            //var subShiftFilter = $('#subShift').val();
            var lphTypeFilter = $('#lphtype').val();
            var status = $('#status').val();
            var main_source = $('#select_source').val();
            var location1 = $('.selection-location').val();
            var location2 = $('.selection-department').val();
            var location3 = $('.selection-subdepartment').val();

            var table = $('#approvalTable').dataTable({
			"autoWidth": false,
			"processing": true,
			"serverSide": true,
			"filter": true,
			"orderMulti": false,
            "pageLength": 25,
            "destroy": true,
            "order": [[ 6, "desc" ]],
			"ajax": {
                "url": fastApp.BaseUrl + "/ApprovalPrimary/GetData",
                "data": { dateFilter: dateFilter, shift: shiftFilter, lphtype: lphTypeFilter, status: status, main_source: main_source, location1:location1, location2:location2, location3:location3 },
				"type": "POST",
				"datatype": "json"
                },
                "drawCallback": function (settings) {
                    $('#loading_overlay').addClass('d-none');
                },
            "columnDefs":
                [
                    {
					    "targets": [0],
                        "searchable": true,
					    "orderable": true
				    },
				    {
					    "targets": [1],
					    "searchable": true,
                        "orderable": true,
				    },
				    {
					    "targets": [2],
					    "searchable": true,
					    "orderable": true
				    },
				    {
					    "targets": [3],
					    "searchable": true,
					    "orderable": true
				    },
				    {
					    "targets": [4],
					    "searchable": true,
					    "orderable": true
				    },
				    {
					    "targets": [5],
					    "searchable": true,
					    "orderable": true
				    },
				    {
					    "targets": [6],
					    "searchable": true,
					    "orderable": true
				    },
				    {
					    "targets": [7],
					    "searchable": true,
					    "orderable": true
				    }
				],
			"columns": [
                    { "data": "LPHSubmissionID", "name": "LPHSubmissionID", "title": "ID", "autoWidth": false },
                    {
					    "data": "Date",
					    render: function (data, type, row) {
						    if (data)
							    return moment(data).format("DD-MMM-YY");
						    else
							    return '';
					    }
                    },
				    { "data": "Shift", "name": "Shift", "autoWidth": true },
                    { "data": "LPHType", "name": "LPHType", "title": "LPH Type", "autoWidth": true,
                        render: function (data, type, row) {
                            console.log("---" + data + "---");
                            if (data == "LPHPrimaryKretekLineAddback")
                                return "Kretek Line - Addback";
                            else if (data == "LPHPrimaryDiet")
                                 return "Intermediate Line - DIET";
                            else if (data == "LPHPrimaryCloveInfeedConditioning")
                                 return "Intermediate Line - Clove Feeding & DCCC";
                            else if (data == "LPHPrimaryCSFCutDryPacking")
                                return "Intermediate Line - CSF Cut Dry & Packing";
                            else if (data == "LPHPrimaryCSFInfeedConditioning")
                                return "Intermediate Line - CSF Feeding & DCCC";
                            else if (data == "LPHPrimaryCloveCutDryPacking")
                                return "Intermediate Line - Clove Cut Dry & Packing";
                            else if (data == "LPHPrimaryRTC")
                                return "Intermediate Line - RTC";
                            else if (data == "LPHPrimaryKitchen")
                                return "Intermediate Line - Casing Kitchen";
                            else if (data == "LPHPrimaryWhiteLineOTP")
                                return "White Line OTP - Process Note";
                            else if (data == "LPHPrimaryKretekLineFeeding")
                                return "Kretek Line - Feeding KR & RJ";
                            else if (data == "LPHPrimaryKretekLineConditioning")
                                return "Kretek Line - DCCC KR & RJ";
                            else if (data == "LPHPrimaryKretekLineCuttingDrying")
                                return "Kretek Line - Cut Dry";
                            else if (data == "LPHPrimaryKretekLinePacking")
                                return "Kretek Line - Packing";
                            else if (data == "LPHPrimaryCresFeedingConditioning")
                                return "Kretek Line - CRES Feeding & DCCC";
                            else if (data == "LPHPrimaryCresDryingPacking")
                                return "Kretek Line - CRES Cut Dry & Packing";
                            else if (data == "LPHPrimaryWhiteLineFeedingWhite")
                                return "White Line PMID - Feeding White";
                            else if (data == "LPHPrimaryWhiteLineDCCC")
                                return "White Line PMID - DCCC";
                            else if (data == "LPHPrimaryWhiteLineCuttingFTD")
                                return "White Line PMID - Cutting + FTD";
                            else if (data == "LPHPrimaryWhiteLineAddback")
                                return "White Line PMID - Addback";
                            else if (data == "LPHPrimaryWhiteLinePackingWhite")
                                return "White Line PMID - Packing White";
                            else if (data == "LPHPrimaryWhiteLineFeedingSPM")
                                return "White Line PMID - Feeding SPM";
                            else if (data == "LPHPrimaryISWhiteFeeding")
                                return "White Line PMID - Feeding IS White";
                            else if (data == "LPHPrimaryISWhiteCutDry")
                                return "White Line PMID - Cut Dry IS White";
                            else
								return data;
                        }
                    },
                    { "data": "User", "name": "User", "title": "User", "autoWidth": false },
                    {
                        "data": "Status", "name": "Status", "title": "Status", "autoWidth": false
      //                  , 
						//render: function (data, type, full, meta) {
						//	if (full['IsNeedMyApproval']) {
						//		return 'Waiting for Approval';
      //                      } else {
						//		return 'Approved';
						//	}
						//}
                    },
				    {
                        "data": "ModifiedDate", "name": "ModifiedDate", "title": "Last Update", "autoWidth": false,
                        render: function (data, type, row) {
						    if (data)
							    return moment(data).format("DD-MMM-YY hh:mm");
						    else
							    return '';
                        }
                    },
				    {
					    "render": function (data, type, full, meta) {
							if (full['IsNeedMyApproval']) {
								//return '<button class="btn-menu btn-default" onclick="Approve(\'' + full['ID'] + '\',\'' + full['LPHSUBID'] + '\')" data-toggle="modal" data-target="#ApproveModal" title="Approve"><i class="fa fa-check"></i></button>';
                                return '<button class="btn-menu btn-default" onclick="Approve(\'' + full['ID'] + '\',\'' + full['LPHSubmissionID'] + '\') "title="Approve"><i class="fa fa-check"></i></button>';
                            } else {
                                return '<button class="btn-menu btn-default" onclick="Submitted(\'' + full['ID'] + '\',\'' + full['LPHSubmissionID'] + '\') "title="See Submission"><i class="fa fa-eye"></i></button>';
                                //return '-';
							}
						}
					}
				]
            });
        });

		var stack_bottomright = { "dir1": "up", "dir2": "left", "firstpos1": 15, "firstpos2": 15 };

		function GenerateExcel() {
			var notice = new PNotify({
				title: "Generating Excel file",
				text: "Please wait a few seconds....",
				addclass: 'stack-bottomright',
				width: "400px",
				type: 'success',
				stack: stack_bottomright,
			});

			notice.get().click(function () {
				notice.remove();
			});

            var dateFilter = $('#flDate').val();
            var shiftFilter = $('#shift').val() != "" ? $('#shift').val() : "";
            var lphTypeFilter = $('#lphtype').val();
            var status = $('#status').val();
            var main_source = $('#select_source').val();
            var location1 = $('.selection-location').val();
            var location2 = $('.selection-department').val();
            var location3 = $('.selection-subdepartment').val();

            window.open(
              '@Url.Action("ExportExcel", "ApprovalPrimary")?dateFilter=' + dateFilter + '&shift=' + shiftFilter + '&lphtype=' + lphTypeFilter + '&status=' + status + '&main_source=' + main_source + '&location1=' + location1 + '&location2=' + location2 + '&location3=' + location3,
              '_blank'
            );
		}
    </script>
}