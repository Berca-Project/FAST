
@model Fast.Web.Models.Report.ExtractDataModel

@using Fast.Web.Resources;
@{
    ViewBag.Title = "Index";
}

@using (Html.BeginForm("ExtractExcel", "ExtractDataSP", FormMethod.Post, new { encType = "multipart/form-data" }))
{
    <div class="content content-fixed lph-form">
        <div class="container-fluid pd-x-0 pd-lg-x-10 pd-xl-x-0">
            <div class="d-sm-flex align-items-center justify-content-between mg-b-20 mg-lg-b-25 mg-xl-b-30">
                <div>
                    <nav aria-label="breadcrumb">
                        <ol class="breadcrumb breadcrumb-style1 mg-b-10">
                            <li class="breadcrumb-item"><a href="#">Extract Data</a></li>
                            <li class="breadcrumb-item active" aria-current="page">Extract Data SP</li>
                        </ol>
                    </nav>
                    <h4 class="mg-b-0 tx-spacing--1">Extract Data SP</h4>
                </div>
            </div>
            <div class="row">
                <div class="col-12 mg-b-20">
                    <div class="card">
                        <div class="card-body">
                            <div class="form-group row">
                                <div class="col-2">
                                    <label class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-t-10 tx-color-03">LPH Type</label>
                                </div>
                                <div class="col-3">
                                    @Html.DropDownListFor(x => x.LPHType, (IEnumerable<SelectListItem>)ViewBag.TypeList, new { @class = "form-control", @id = "ddlType" })
                                </div>
                            </div>
                            <div class="form-group row">
                                <div class="col-2">
                                    <label class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-t-10 tx-color-03">@UIResources.ProductionCenter</label>
                                </div>
                                <div class="col-3">
                                    @Html.DropDownListFor(x => x.ProdCenterID, (IEnumerable<SelectListItem>)ViewBag.ProductionCenterList, new { @class = "form-control", @id = "ddlProdCenter2" })
                                </div>
                            </div>
                            <div class="form-group row">
                                <div class="col-2">
                                    <label class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-t-10 tx-color-03">Start Date</label>
                                </div>
                                <div class="col-3">
                                    @Html.TextBoxFor(x => x.StartDate, "{0:yyyy-mm-dd}", new { @class = "form-control", @id = "tbDateStart", autocomplete = "off" })
                                </div>
                            </div>
                            <div class="form-group row">
                                <div class="col-2">
                                    <label class="tx-10 tx-uppercase tx-medium tx-spacing-1 mg-t-10 tx-color-03">End Date</label>
                                </div>
                                <div class="col-3">
                                    @Html.TextBoxFor(x => x.EndDate, "{0:yyyy-mm-dd}", new { @class = "form-control", @id = "tbDateEnd", autocomplete = "off" })
                                </div>
                            </div>

                            <div class="modal-footer pd-x-20 pd-y-15">
                                <button type="submit" class="btn btn-primary">Extract</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div><!-- row -->
        </div><!-- container -->
    </div><!-- content -->
}

@section Scripts{
    <script src="~/Content/dashforge/lib/prismjs/prism.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $('#tbDateStart').datepicker({
                format: "dd-M-yy",
                changeMonth: true,
                changeYear: true
            });
            $('#tbDateEnd').datepicker({
                format: "dd-M-yy",
                changeMonth: true,
                changeYear: true
            });

        });
          var stack_bottomright = { "dir1": "up", "dir2": "left", "firstpos1": 15, "firstpos2": 15 };

			var result = "@ViewBag.Result";
			var error = "@ViewBag.ErrorMessage";
			var message = "@ViewBag.Message";

			if (result != "") {
				if (result == "True") {
					if (message == "") {
						var notice = new PNotify({
							title: "@UIResources.Confirmation",
							text: "@UIResources.ExtractSuccess",
							width: "400px",
							type: 'success',
							addclass: 'stack-bottomright',
							stack: stack_bottomright,
							delay: 2000
						});

						notice.get().click(function () {
							notice.remove();
						});
					}
					else {
						var notice = new PNotify({
							title: "@UIResources.Confirmation",
							text: message,
							width: "400px",
							type: 'success',
							addclass: 'stack-bottomright',
							stack: stack_bottomright,
							delay: 2000
						});

						notice.get().click(function () {
							notice.remove();
						});
					}
				}
				else {
					if (error == "") {
						var notice = new PNotify({
							title: "@UIResources.ErrorMessage",
							text: "@UIResources.DataNotFound",
							width: "400px",
							type: 'error',
							addclass: 'stack-bottomright',
							delay: 2000
						});

						notice.get().click(function () {
							notice.remove();
						});
					}
					else {
						var notice = new PNotify({
							title: "@UIResources.ErrorMessage",
							text: error,
							width: "400px",
							type: 'error',
							addclass: 'stack-bottomright',
							delay: 2000
						});

						notice.get().click(function () {
							notice.remove();
						});
					}
				}
			}

    </script>
}
