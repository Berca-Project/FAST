@model Fast.Web.Models.LPH.LPHHeaderModel
@using Newtonsoft.Json;
@using Fast.Web.Resources;
@{
    ViewBag.Title = "Packer";
    var selected = "";
}

@* chanif: tambah css untuk select2 *@
@section CSS_lib{
    <link href="~/Content/dashforge/lib/select2/css/select2.min.css" rel="stylesheet">
}
@section Styles{

    <style>
        .tableWrapper {
            position: relative;
            overflow: auto;
            max-height: 150px;
            transform: translateZ(0);
        }

            .tableWrapper table {
                border-collapse: collapse;
                width: 100%;
            }

            .tableWrapper thead th, .tableWrapper thead td {
                position: sticky;
                background: #066fcb;
                z-index: 100;
                border: none;
            }

            .tableWrapper table tfoot td {
                position: sticky;
                bottom: 0;
                z-index: 100;
            }

            .tableWrapper .input td {
                background: white;
            }

            .tableWrapper .summary-body td {
                font-weight: bold;
                background-color: #d8eafe;
                color: #000;
            }

        .fa {
            padding: 5px;
            cursor: pointer;
        }

        .fas {
            cursor: pointer;
        }

        .input-img {
            width: 100%;
            height: 150px;
            object-fit: cover;
        }

        .input-img-card {
            margin-left: 5px;
            margin-right: 5px;
        }

        .modal-body {
            position: relative;
            margin-top: 10px;
        }

            .modal-body .close {
                padding: 5px;
                position: absolute;
                top: -5px;
                right: 5px;
                font-size: 15px;
                color: black;
                z-index: 1000;
            }

        .stepper {
            position: relative;
        }

            .stepper:before {
                top: 15px;
                bottom: 0;
                position: absolute;
                content: " ";
                width: 100%;
                height: 1px;
                background: #f1f1f1;
                z-index: 0;
            }

        .stepper-step {
            text-align: center;
            position: relative;
        }

            .stepper-step.active .stepper-btn {
                background: #37b6fa;
                color: white;
                font-weight: 500;
                border: 0
            }

        .stepper-btn {
            width: 30px;
            height: 30px;
            text-align: center;
            padding: 6px 0;
            font-size: 12px;
            line-height: 1.428571429;
            border-radius: 15px;
            background: #e6e6e6;
            color: #9c9c9c;
        }

        .wizard-button {
            margin: 5px;
        }

            .wizard-button.active {
                filter: brightness(0.75);
            }
        /* chanif: tolong tambahkan css dari sini sampai bawah untuk memperbaiki tampilan select2 */

        .select2-container--default .select2-selection--single {
            height: 25px;
            min-height: 25px;
        }

        .select2-container--default .select2-selection--multiple {
            min-height: 25px;
        }

        .select2-container--default .select2-selection--single .select2-selection__arrow {
            display: none;
        }

        .select2-container--default .select2-selection--single .select2-selection__rendered {
            font-size: 13px;
            padding: 5px;
        }

        .select2-container--default .select2-selection--multiple .select2-selection__rendered {
            font-size: 13px;
            padding: 0 0 0 5px;
        }

        .select2-search--dropdown {
            padding: 1px;
        }

        .select2-container--default .select2-search--dropdown .select2-search__field {
            padding: 3px 5px;
        }

        .select2-results {
            font-size: 13px;
        }

        .select2-results__option {
            padding: 3px;
        }

        table.dataTable thead .sorting_asc, table.dataTable thead .sorting_desc {
            background-color: transparent
        }

        .select2-container--default .select2-search--inline .select2-search__field {
            margin-top: 0;
            padding: 0;
        }

        .select2-results__option[aria-selected=true] {
            display: none;
        }

        #generalInfo label {
            padding-right: 0;
        }
    </style>
}

<div class="content content-fixed lph-form">
    <div class="container-fluid pd-x-0 pd-lg-x-10 pd-xl-x-0">
        <div class="d-sm-flex align-items-center justify-content-between mg-b-20 mg-lg-b-25 mg-xl-b-30">
            <div>
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb breadcrumb-style1 mg-b-10">
                        <li class="breadcrumb-item"><a href="#">LPH Form</a></li>
                        <li class="breadcrumb-item active" aria-current="page">Packer</li>
                    </ol>
                </nav>
                <h4 class="mg-b-0 tx-spacing--1">LPH Cigarillo Packer</h4>
            </div>
            <div class="d-none d-md-block">
                <button id="goPrev" class="btn btn-sm pd-x-15 btn-white btn-uppercase mg-l-5"><i data-feather="chevron-left" class="wd-10 mg-r-5"></i> Prev</button>
                <button class="btn btn-sm pd-x-15 btn-primary btn-uppercase mg-l-5 button" id="btnHistory"><i data-feather="clock" class="wd-10 mg-r-5"></i> History</button>
                @*<button class="btn btn-sm pd-x-15 btn-white btn-uppercase" data-toggle="modal" data-target="#photo-modal"><i data-feather="camera" class="wd-10 mg-r-5"></i> Photo</button>*@
                <button class="btn btn-sm pd-x-15 btn-white btn-uppercase" id="btnSaveDraft"><i data-feather="save" class="wd-10 mg-r-5"></i> Save</button>
                <button class="btn btn-sm pd-x-15 btn-uppercase btn-primary d-none" id="btnSave"><i data-feather="save" class="wd-10 mg-r-5"></i> Submit</button>
                <button class="btn btn-sm pd-x-15 btn-uppercase btn-secondary d-none" id="btnReset"><i data-feather="refresh-cw" class="wd-10 mg-r-5"></i> Reset</button>
                <button class="btn btn-sm pd-x-15 btn-white btn-uppercase mg-l-5" onclick="javascript:window.print()"><i data-feather="printer" class="wd-10 mg-r-5"></i> Print</button>
            </div>
        </div>

        <div class="row">
            <div class="col-12 mg-b-20">
                <div class="card" id="generalInfo">
                    <div class="card-header bg-primary tx-white tx-center font-weight-bold">Information</div>
                    <div class="card-body d-flex">
                        <div class="flex-1">
                            <div class="form-group row">
                                <label class="col-3 col-form-label">Date</label>
                                <div class="col-5">
                                    <input type="text" class="form-control information-datepicker mandatory" id="txtDateInfo" value="@(Model.Date.ToString("ddd, dd-MMM-yy"))">
                                </div>
                                <label class="col-2 col-form-label tx-right pd-r-0-f">Week</label>
                                <div class="col-2">
                                    <input type="text" class="form-control" id="txtWeekNumber" disabled value="@(Model.Week)">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-3 col-form-label">Machine *</label>
                                <div class="col-4">
                                    <select class="form-control select2 mandatory" id="machInfo">
                                        <option value="">Select Machine</option>
                                        @foreach (Fast.Web.Models.MachineModel machine in ViewBag.Machines)
                                        {
                                            selected = "";
                                            if (Model.Machines.Count != 0 && Model.Machines[0] != null)
                                            {
                                                if (machine.Code == Model.Machines[0])
                                                {
                                                    selected = "selected";
                                                }

                                                if (machine.Code == ViewBag.MachineSelected)
                                                {
                                                    selected = "selected";
                                                }
                                            }
                                            else
                                            {
                                                if (machine.Code == ViewBag.MachineSelected)
                                                {
                                                    selected = "selected";
                                                }
                                            }

                                            <option value="@(machine.Code)" @selected>@(machine.Code)</option>
                                        }
                                    </select>
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-3 col-form-label">Brand *</label>
                                <div class="col-9">
                                    <select class="form-control select2 mandatory" id="brandInfo">
                                        <option value="">Select Brand</option>
                                        @foreach (Fast.Web.Models.ReferenceDetailModel brand in ViewBag.Brand)
                                        {
                                            selected = "";
                                            if (Model.Brands.Count != 0 && Model.Brands[0] != null)
                                            {
                                                if (brand.Code == Model.Brands[0])
                                                {
                                                    selected = "selected";
                                                }
                                                if (brand.Code == ViewBag.BrandSelected)
                                                {
                                                    selected = "selected";
                                                }

                                            }
                                            else
                                            {
                                                if (brand.Code == ViewBag.BrandSelected)
                                                {
                                                    selected = "selected";
                                                }
                                            }

                                            <option value="@(brand.Code)" @selected>[@(brand.Code)] @brand.Description</option>
                                        }
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="divider-text divider-vertical"></div>
                        <div class="flex-1">
                            <div class="form-group row">
                                <label class="col-3 col-form-label">Prodtech *</label>
                                <div class="col-8">
                                    <select class="form-control select2 mandatory" id="prodTech" multiple>

                                        @foreach (Fast.Web.Models.EmployeeModel employee in ViewBag.Prodtechs)
                                        {
                                            selected = "";
                                            if (Model.ProdTech != null && Model.ProdTech.Trim() != "")
                                            {
                                                if (employee.EmployeeID == Model.ProdTech)
                                                {
                                                    selected = "selected";
                                                }
                                            }
                                            else
                                            {
                                                if (employee.EmployeeID == ViewBag.AccountEmployeeID || employee.EmployeeID == ViewBag.ProdtechSelected)
                                                {
                                                    selected = "selected";
                                                }
                                            }
                                            <option value="@(employee.EmployeeID)" @selected>[@(employee.EmployeeID)] @employee.FullName</option>
                                        }
                                    </select>
                                </div>
                            </div>
                            @*<div class="form-group row">
                                    <label class="col-3 col-form-label">Foreman</label>
                                    <div class="col-8">
                                        <select class="form-control select2 mandatory" id="foreman">
                                            <option value="">Select Foreman</option>
                                            @foreach (Fast.Web.Models.EmployeeModel employee in ViewBag.Foremans)
                                            {
                                                selected = "";
                                                if (Model.Foreman != null && Model.Foreman.Trim() != "")
                                                {
                                                    if (employee.EmployeeID == Model.Foreman)
                                                    {
                                                        selected = "selected";
                                                    }
                                                }
                                                <option value="@(employee.EmployeeID)" @selected>[@(employee.EmployeeID)] @employee.FullName</option>
                                            }
                                        </select>
                                    </div>
                                </div>*@
                            <div class="form-group row">
                                <label class="col-3 col-form-label">Mechanic *</label>
                                <div class="col-8">
                                    <select class="form-control select2 mandatory" id="mekanik">
                                        <option value="">Select Mechanic</option>
                                        @foreach (Fast.Web.Models.EmployeeModel employee in ViewBag.Mechanics)
                                        {
                                            selected = "";
                                            if (Model.Mechanic != null && Model.Mechanic.Trim() != "")
                                            {
                                                if (employee.EmployeeID == Model.Mechanic)
                                                {
                                                    selected = "selected";
                                                }
                                            }
                                            else
                                            {
                                                if (employee.EmployeeID == ViewBag.MechanicSelected)
                                                {
                                                    selected = "selected";
                                                }
                                            }
                                            <option value="@(employee.EmployeeID)" @selected>[@(employee.EmployeeID)] @employee.FullName</option>
                                        }
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="flex-1">
                            <div class="form-group row">
                                <label class="col-4 col-form-label">Electrician *</label>
                                <div class="col-8">
                                    <select class="form-control select2 mandatory" id="elektrik">
                                        <option value="">Select Electrician</option>
                                        @foreach (Fast.Web.Models.EmployeeModel employee in ViewBag.Electrics)
                                        {
                                            selected = "";
                                            if (Model.Electrician != null && Model.Electrician.Trim() != "")
                                            {
                                                if (employee.EmployeeID == Model.Electrician)
                                                {
                                                    selected = "selected";
                                                }
                                            }
                                            else
                                            {
                                                if (employee.EmployeeID == ViewBag.ElectricSelected)
                                                {
                                                    selected = "selected";
                                                }
                                            }
                                            <option value="@(employee.EmployeeID)" @selected>[@(employee.EmployeeID)] @employee.FullName</option>
                                        }
                                    </select>
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-4 col-form-label">Supervisor *</label>
                                <div class="col-8">
                                    <select class="form-control select2 mandatory" id="teamLeader">
                                        <option value="">Select Mechanic</option>
                                        @foreach (Fast.Web.Models.EmployeeModel employee in ViewBag.Leaders)
                                        {
                                            selected = "";
                                            if (Model.TeamLeader != null && Model.TeamLeader.Trim() != "")
                                            {
                                                if (employee.EmployeeID == Model.TeamLeader)
                                                {
                                                    selected = "selected";
                                                }
                                            }
                                            else
                                            {
                                                if (employee.EmployeeID == ViewBag.AccountSpvEmployeeID)
                                                {
                                                    selected = "selected";
                                                }
                                            }
                                            <option value="@(employee.EmployeeID)" @selected>[@(employee.EmployeeID)] @employee.FullName</option>
                                        }
                                    </select>
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-4 col-form-label" style="padding-right: 3px;">PO Number</label>
                                <div class="col-8">
                                    <select class="form-control select2" name="PONumber" id="PONumber">
                                        <option value="">Select PO Number</option>
                                        @foreach (Fast.Web.Models.WppModel wpp in ViewBag.WPP)
                                        {
                                            <option value="@(wpp.PONumber)">@(wpp.PONumber)</option>
                                        }
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="divider-text divider-vertical"></div>
                        <div class="flex-1">
                            <div class="form-group row">
                                <label class="col-4 col-form-label">Shift / Group *</label>
                                <div class="col-3">
                                    <input type="text" class="form-control mandatory" id="shift" value="@(Model.Shift)">
                                </div>
                                <label class="col-1 col-form-label tx-center">/</label>
                                <div class="col-3">
                                    @*<input type="text" class="form-control mandatory" id="group" value="@(Model.Group)">*@
                                    <select class="form-control select2 mandatory" name="Group" id="group">
                                        <option value="">Select Group</option>
                                        @foreach (Fast.Web.Models.ReferenceDetailModel detail in ViewBag.referenceGroup)
                                        {
                                            <option value="@(detail.Code)">@(detail.Code)</option>
                                        }
                                    </select>
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-4 col-form-label">Start / Stop *</label>
                                <div class="col-3">
                                    <div class="input-group">
                                        <input id="inputTimeStart" class="form-control input-time" value="@(Model.Start):000" disabled>
                                    </div>
                                </div>
                                <label class="col-1 col-form-label">/</label>
                                <div class="col-3">
                                    <div class="input-group">
                                        <input id="inputTimeStop" class="form-control input-time" value="@(Model.Stop):000" disabled>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div><!--INFORMATION-->

            <div class="col-12 mg-b-20">
                <div class="card">
                    <div class="card-header bg-primary tx-white tx-center font-weight-bold">
                        Handover Logbook
                        <button class="btn btn-xs pd-x-15 btn-white btn-uppercase" type="button" style="float:right; padding:1px 0px;" id="hideHandover"><i class="fas fa-eye-slash"></i> Hide</button>
                    </div>

                    <div class="card-body" id="multicollapse">
                        <div class="tableWrapper" style="max-height: 210px">
                            <table class="table table-bordered table-hover table-striped">
                                <thead class="thead-info">
                                    <tr class="tx-center">
                                        <th style="min-width:120px;">Stops and Location</th>
                                        <th style="min-width:100px;"># of Stops</th>
                                        <th style="min-width:120px;">Initial Root Cause (Describe the issue) / Action Taken &amp; Impact</th>
                                        <th style="min-width:120px;">Action Taken in your shift</th>
                                        <th width="80px">Action</th>
                                    </tr>
                                </thead>
                                <tbody id="logbook">
                                </tbody>
                                <tfoot>
                                    <tr class="input">
                                        <td><input type="text" class="form-control" name="StopAndLocation"></td>
                                        <td><input type="number" onkeypress="validateNumber(event)" placeholder="0" class="form-control" name="NOfStop"></td>
                                        <td><input type="text" class="form-control" name="InitialCause"></td>
                                        <td><input type="text" class="form-control" name="ActionTaken"></td>
                                        <td class="tx-center"><i data-target="logbook" class="fa fa-plus-circle add-to-table"></i></td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                        <div class="tableWrapper" style="max-height: 210px">
                            <table class="table table-bordered table-hover table-striped">
                                <thead class="thead-info">
                                    <tr class="tx-center">
                                        <th style="width:50%;">Action proposed for next shift</th>
                                        <th style="min-width:90px;">Owner</th>
                                        <th style="min-width:70px;">Start Time</th>
                                        <th style="min-width:70px;">End Time</th>
                                        <th style="min-width:60px;">Duration (Min)</th>
                                        <th style="min-width:100px;">Status</th>
                                        <th width="80px">Action</th>
                                    </tr>
                                    <tr class="summary-body">
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td></td>
                                        <td>0</td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                </thead>
                                <tbody id="action">
                                </tbody>
                                <tfoot>
                                    <tr class="input">
                                        <td><input type="text" class="form-control" name="NextAction"></td>
                                        <td><input type="text" class="form-control" name="NextOwner"></td>
                                        <td><input type="text" class="form-control date" name="NextStart" id="start" onblur="javascript:countDuration('start','end','duration')"></td>
                                        <td><input type="text" class="form-control date" name="NextEnd" id="end" onblur="javascript:countDuration('start','end','duration')"></td>
                                        <td><input type="text" class="form-control disabled" disabled value="0" name="NextDurasi" id="duration"></td>
                                        <td>
                                            <select class="form-control select2" name="Status">
                                                <option label="Choose one"></option>
                                                <option value="ONPROGRESS">ONPROGRESS</option>
                                                <option value="DONE">DONE</option>
                                            </select>
                                        </td>
                                        <td class="tx-center"><i data-target="action" class="fa fa-plus-circle add-to-table"></i></td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>
                </div>
            </div> <!-- PROBLEM MESIN -->

            <div class="col-4 mg-b-20">
                <div class="card">
                    <div class="card-header bg-primary tx-white tx-center font-weight-bold">Product Information</div>
                    <div class="card-body d-flex">
                        <div class="col-12">
                            <div class="form-group row">
                                <label class="col-6 col-form-label font-weight-bold"></label>
                                <label class="col-2 col-form-label font-weight-bold tx-center">Slof</label>
                                <label class="col-2 col-form-label font-weight-bold tx-center">TB</label>
                                <label class="col-2 col-form-label font-weight-bold tx-center">ZB</label>
                            </div>
                            <div class="form-group row">
                                <label class="col-5 col-form-label">Initial Stock</label>
                                <div class="col-1">
                                    <i onclick="javascript:editInitialStock()" class="fa fa-edit edit small"></i>
                                </div>
                                <div class="col-2">
                                    <input type="number" onkeypress="validateNumber(event)" class="form-control" placeholder="0" id="InitialSlof" disabled>
                                </div>
                                <div class="col-2">
                                    <input type="number" onkeypress="validateNumber(event)" class="form-control" placeholder="0" id="InitialTB" disabled>
                                </div>
                                <div class="col-2">
                                    <input type="number" onkeypress="validateNumber(event)" class="form-control" placeholder="0" id="InitialZB" disabled>
                                </div>

                            </div> <!-- initial stock -->
                            <div class="form-group row">
                                <label class="col-6 col-form-label">Reworked</label>
                                <div class="col-2">
                                    <input type="number" onkeypress="validateNumber(event)" class="form-control" id="ReworkSlof" placeholder="0">
                                </div>
                                <div class="col-2">
                                    <input type="number" onkeypress="validateNumber(event)" class="form-control" id="ReworkTB" placeholder="0">
                                </div>
                                <div class="col-2">
                                    <input type="number" onkeypress="validateNumber(event)" class="form-control" id="ReworkZB" placeholder="0">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-6 col-form-label">QC, Admin, dll</label>
                                <div class="col-2">
                                    <input type="number" onkeypress="validateNumber(event)" class="form-control" id="QCSlof" placeholder="0">
                                </div>
                                <div class="col-2">
                                    <input type="number" onkeypress="validateNumber(event)" class="form-control" id="QCTB" placeholder="0">
                                </div>
                                <div class="col-2">
                                    <input type="number" onkeypress="validateNumber(event)" class="form-control" id="QCZB" placeholder="0">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-6 col-form-label">Last Stock</label>
                                <div class="col-2">
                                    <input type="number" onkeypress="validateNumber(event)" class="form-control" value="0" id="LastStockSlof">
                                </div>
                                <div class="col-2">
                                    <input type="number" onkeypress="validateNumber(event)" class="form-control" value="0" id="LastStockTB">
                                </div>
                                <div class="col-2">
                                    <input type="number" onkeypress="validateNumber(event)" class="form-control" value="0" id="LastStockZB">
                                </div>
                            </div> <!-- last stock -->

                            <div class="form-group row">
                                <label class="col-6 col-form-label font-weight-bold">Result</label>
                                <div class="col-3">
                                    <input type="number" onkeypress="validateNumber(event)" class="form-control" id="ResultProduct" value="0" disabled>
                                </div>
                                <label class="col-2 col-form-label">Pack</label>
                            </div>
                            <div class="form-group row">
                                <label class="col-6 col-form-label font-weight-bold">Input Cigarette</label>
                                <div class="col-3">
                                    <input type="number" onkeypress="validateNumber(event)" class="form-control" id="InputTray" value="0">
                                </div>
                                <label class="col-2 col-form-label">Tray</label>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
            <div class="col-3 mg-b-20">
                <div class="card">
                    <div class="card-header bg-primary tx-white tx-center font-weight-bold">Pemeriksaan Lem pada Glue Tank</div>
                    <div class="card-body d-flex">
                        <div class="col-12">
                            <div class="form-group row">
                                <label class="col-6 col-form-label tx-bold">
                                    Item Name
                                </label>
                                <label class="col-6 col-form-label tx-bold">
                                    Kondisi Lem
                                </label>
                            </div>
                            <div class="form-group row">
                                <label class="col-6 col-form-label">
                                    Lem Pack
                                </label>
                                <div class="col-6">
                                    <select class="form-control select2" id="LemPack">
                                        <option value="NA">NA</option>
                                        <option value="YES">OK</option>
                                        <option value="NO">NOT OK</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-6 col-form-label">
                                    Lem Bandrol
                                </label>
                                <div class="col-6">
                                    <select class="form-control select2" id="LemBandrol">
                                        <option value="NA">NA</option>
                                        <option value="YES">OK</option>
                                        <option value="NO">NOT OK</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
            <div class="col-3 mg-b-20">
                <div class="card">
                    <div class="card-header bg-primary tx-white tx-center font-weight-bold">Data Afkir</div>
                    <div class="card-body d-flex">
                        <div class="flex-1">
                            <div class="form-group row">
                                <label class="col-4 col-form-label">Cigarette Reject </label>
                                <div class="col-5">
                                    <input type="number" onkeypress="validateNumber(event)" class="form-control" id="CigarRejectAfkir" value="">
                                </div>
                                <label class="col-2 col-form-label">Kg</label>
                            </div>
                            <div class="form-group row">
                                <label class="col-4 col-form-label">Etiket  </label>
                                <div class="col-5">
                                    <input type="number" onkeypress="validateNumber(event)" class="form-control" id="EtiketAfkir" value="">
                                </div>
                                <label class="col-2 col-form-label">Kg</label>
                            </div>

                            <div class="form-group row">
                                <div class="col-4">
                                    <input type="text" class="form-control" id="AfkirBlank1" value="">
                                </div>
                                <div class="col-5">
                                    <input type="number" onkeypress="validateNumber(event)" class="form-control" id="AfkirBlank2" value="">
                                </div>
                                <label class="col-2 col-form-label">Kg</label>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
            <div class="col-2 mg-b-20">
                <div class="card">
                    <div class="card-header bg-primary tx-white tx-center font-weight-bold">Production Result</div>
                    <div class="card-body d-flex">
                        <div class="col-12">

                            <div class="form-group row">
                                <label class="col-4 col-form-label">Pack</label>
                                <div class="col-8">
                                    <input type="number" onkeypress="validateNumber(event)" class="form-control" id="ResultPack" placeholder="0" disabled>
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-4 col-form-label">Box</label>
                                <div class="col-8">
                                    <input type="number" onkeypress="validateNumber(event)" class="form-control" id="ResultBox" placeholder="0">
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
            <div class="col-12 mg-b-20">
                <div class="card">
                    <div class="card-header bg-primary tx-white tx-center font-weight-bold">Bandrol Information</div>
                    <div class="card-body row" style="margin:0">
                        <div class="col-4" style="padding-right: 15px;">
                            <div class="tableWrapper" style="max-height: 180px">
                                <table class="table table-bordered table-hover table-striped">
                                    <thead class="thead-info">
                                        <tr>
                                            <th>Take</th>
                                            <th>Kode</th>
                                            <th>Quantity (pcs)</th>
                                            <th style="min-width:80px;"></th>
                                        </tr>
                                        <tr class="summary-body">
                                            <td>0</td>
                                            <td></td>
                                            <td>0</td>
                                            <td></td>
                                        </tr>
                                    </thead>
                                    <tbody id="bandroltake">
                                    </tbody>

                                    <tfoot>
                                        <tr class="input">
                                            <td><input type="number" onkeypress="validateNumber(event)" id="bandrolIndex" class="form-control" value="" name="take"></td>
                                            <td><input type="text" class="form-control" name="kode"></td>
                                            <td><input type="number" onkeypress="validateNumber(event)" class="form-control" name="weight"></td>
                                            <td class="tx-center"><i data-target="bandroltake" class="fa fa-plus-circle add-to-table"></i></td>
                                        </tr>
                                    </tfoot>

                                </table>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="form-group row">
                                <label class="col-7  col-form-label">Received <span style="font-size:10px;"><b>( a )</b></span></label>
                                <div class="col-4">
                                    <input type="number" onkeypress="validateNumber(event)" class="form-control" id="BandrolAccept" placeholder="0">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-7  col-form-label">Use <span style="font-size:10px;"><b>( b )</b></span></label>
                                <div class="col-4">
                                    @*<select class="form-control select2">
                                            <option label="Choose one"></option>
                                            <option value="Accept">Accept</option>
                                            <option value="Rejected">Rejected</option>
                                            <option value="Final">Final</option>
                                            <option value="Destroyed">Destroyed</option>
                                            <option value="Claim">Claim</option>
                                            <option value="IPC">IPC</option>
                                        </select>*@
                                    <input type="text" class="form-control" id="BandrolUse" value="0" disabled>
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-7  col-form-label">Rejected <span style="font-size:10px;"><b>( c )</b></span></label>
                                <div class="col-4">
                                    <input type="number" onkeypress="validateNumber(event)" class="form-control" id="BandrolRejected" placeholder="0">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-7  col-form-label">Final Remaining <span style="font-size:10px;"><b>( d )</b></span></label>

                                <div class="col-4">
                                    <input type="number" onkeypress="validateNumber(event)" class="form-control" id="BandrolFinal" placeholder="0">
                                </div>
                            </div>
                            <div class="form-group row">
                                <span style="font-size:10px; "><b>* ( b = a - c - d - e - f - g )</b></span>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="form-group row">
                                <label class="col-7  col-form-label"> +/- Lost ( Pack - Use ) </label>
                                <div class="col-4">
                                    <input type="text" class="form-control" id="BandrolPackUse" placeholder="0" disabled>
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-7  col-form-label">Destroyed <span style="font-size:10px;"><b>( e )</b></span></label>
                                <div class="col-4">
                                    <input type="text" class="form-control" id="BandrolDestroy" placeholder="0">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-7  col-form-label">Claim <span style="font-size:10px;"><b>( f )</b></span></label>
                                <div class="col-4">
                                    <input type="number" onkeypress="validateNumber(event)" class="form-control" id="BandrolClaim" placeholder="0">
                                </div>
                            </div>
                            <div class="form-group row">
                                <label class="col-7  col-form-label">IPC <span style="font-size:10px;"><b>( g )</b></span></label>
                                <div class="col-4">
                                    <input type="number" onkeypress="validateNumber(event)" class="form-control" id="BandrolIPC" placeholder="0">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            @*<div class="col-12 mg-b-20">
                    <div class="card">
                        <div class="card-header bg-primary tx-white tx-center font-weight-bold">Capture by Webcam</div>
                        <div class="card-body d-flex input-img-card">
                            <div class="flex-1">
                                <div class="form-group row">
                                    <div class="col-12" id="image_1_hide">
                                        <center>
                                            <img src="~/Content/dashforge/assets/img/upload-img-mini.png" id="image_1" class="input-img rounded mx-auto d-block" onclick="infoId(this)" data-toggle="modal" data-target="#photo-modal" alt="insert image" width="auto">
                                        </center>
                                    </div>
                                    <div class="col-12" id="image_1_show">
                                    </div>

                                    <div class="col-12">
                                        <center>
                                            <label class="col-12 col-form-label"><i>Splacing Reject, Innerframe, OPP</i></label>
                                        </center>
                                    </div>
                                </div>
                            </div>
                            <div class="divider-text divider-vertical"></div>
                            <div class="flex-1">
                                <div class="form-group row">
                                    <div class="col" id="image_2_hide">
                                        <center>
                                            <img src="~/Content/dashforge/assets/img/upload-img-mini.png" id="image_2" class="input-img rounded mx-auto d-block" onclick="infoId(this)" data-toggle="modal" data-target="#photo-modal" alt="insert image" width="auto">
                                        </center>
                                    </div>
                                    <div class="col" id="image_2_show">
                                    </div>

                                    <div class="col-12">
                                        <center>
                                            <label class="col-12 col-form-label"><i>Sampling Innerframe</i></label>
                                        </center>
                                    </div>
                                </div>
                            </div>
                            <div class="divider-text divider-vertical"></div>
                            <div class="flex-1">
                                <div class="form-group row">
                                    <div class="col-12" id="image_3_hide">
                                        <center>
                                            <img src="~/Content/dashforge/assets/img/upload-img-mini.png" id="image_3" class="input-img rounded mx-auto d-block" onclick="infoId(this)" data-toggle="modal" data-target="#photo-modal" alt="insert image" width="auto">
                                        </center>
                                    </div>
                                    <div class="col-12" id="image_3_show">
                                    </div>

                                    <div class="col-12">
                                        <center>
                                            <label class="col-12 col-form-label"><i>Sampling End Label Slof</i></label>
                                        </center>
                                    </div>
                                </div>
                            </div>
                            <div class="divider-text divider-vertical"></div>
                            <div class="flex-1">
                                <div class="form-group row">
                                    <div class="col-12" id="image_4_hide">
                                        <center>
                                            <img src="~/Content/dashforge/assets/img/upload-img-mini.png" id="image_4" class="input-img rounded mx-auto d-block" onclick="infoId(this)" data-toggle="modal" data-target="#photo-modal" alt="insert image" width="auto">
                                        </center>
                                    </div>
                                    <div class="col-12" id="image_4_show">
                                    </div>
                                    <div class="col-12">
                                        <center>
                                            <label class="col-12 col-form-label"><i>Sampling Alufoil</i></label>
                                        </center>
                                    </div>
                                </div>
                            </div>
                            <div class="divider-text divider-vertical"></div>
                            <div class="flex-1">
                                <div class="form-group row">
                                    <div class="col-12" id="image_5_hide">
                                        <center>
                                            <img src="~/Content/dashforge/assets/img/upload-img-mini.png" id="image_5" class="input-img rounded mx-auto d-block" onclick="infoId(this)" data-toggle="modal" data-target="#photo-modal" alt="insert image" width="auto">
                                        </center>
                                    </div>
                                    <div class="col-12" id="image_5_show">
                                    </div>
                                    <div class="col-12">
                                        <center>
                                            <label class="col-12 col-form-label"><i>Sampling Intiket</i></label>
                                        </center>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>*@

            <div class="col-12 mg-b-20">
                <div class="card">
                    <div class="card-header bg-primary tx-white tx-center font-weight-bold">Approval</div>
                    <div class="card-body">
                        <table class="table table-bordered table-hover table-striped" id="dtApproval">
                            <thead class="thead-info">
                                <tr>
                                    <th>Name</th>
                                    <th>Role</th>
                                    <th>Actions</th>
                                    <th style="width:15%;">Date &amp; Time</th>
                                    <th style="width:40%;">Comment</th>
                                </tr>
                            </thead>

                        </table>
                    </div>
                </div>
            </div>


        </div><!-- row -->
    </div><!-- container -->
</div><!-- content -->

<div class="modal fade wizard-modal" id="submission-modal" role="dialog">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-body">
                @*<div class="close"><i data-dismiss="modal" class="fa fa-times"></i></div>*@

                <div id="carousel" class="carousel slide" data-pause="true">
                    <div class="carousel-inner">
                        <div class="carousel-item active">
                            Employee ID: <span id="submission_employee"></span><br />
                            Login Name: <span id="submission_employee_name"></span><br />
                            Your last draft was on <span id="submission_date"></span><br />
                            Do you want to continue or reset?
                        </div>
                    </div>
                </div>

                <hr>
                <div>
                    <center>
                        <button type="button" id="continue_btn" class="wizard-button btn btn-primary continue">Continue</button>
                        <button type="button" id="reset-submission" class="wizard-button btn btn-primary reset">Reset</button>
                    </center>
                </div>

            </div>
        </div>
    </div>

</div>
<div id="submission" data-json='@Html.Raw(JsonConvert.SerializeObject(ViewBag.Reset))' />
<input type="hidden" id="employee_id" value='@ViewBag.AccountEmployeeID' />
<input type="hidden" id="employee_name" value='@ViewBag.AccountName' />
<input type="hidden" id="oneday" value='@ViewBag.OneDay' />

@section Scripts{
    <script src="~/Content/dashforge/lib/cleave.js/cleave.min.js"></script>
    <script src="~/Content/dashforge/lib/select2/js/select2.min.js"></script>
    <script src="~/Content/dashforge/lib/moment/moment.js"></script>

    <script type="text/javascript">
        'use strict'
          $('#btnHistory').on('click', function (e) {
		     location.href = '@Url.Action("Index", "History")';
          });
          $('.datepicker').datepicker({
                format: 'D,d-M-yy',
                //language: 'id-id'
		  });
            $('.information-datepicker').toArray().forEach(function (field) {
                $(field).datepicker({
                    todayHighlight: true,
                    format: 'D, dd-M-yy',
                    startDate: new Date(new Date().setDate(new Date().getDate() - 2)),
                    endDate: new Date(new Date().setDate(new Date().getDate() + 1)),
                    //maxDate: 2,
                    //minDate: -2,
                });
            });

    </script>

    <script>
        var submission;
        $(function () {
            'use strict'

            basicFunction();

            var collectorComponent = [];
            var collectorValue = [];

        // Part Collect Component
            function collectInformationComponent() {
            var dateInfo = {};
            dateInfo.ComponentType="textfield";
            dateInfo.ComponentName = "Date";
            collectorComponent.push(dateInfo);
            var weekInfo = {};
            weekInfo.ComponentType="textfield";
            weekInfo.ComponentName = "Week";
            collectorComponent.push(weekInfo);
            var machineInfo = {};
            machineInfo.ComponentType="textfield";
            machineInfo.ComponentName = "Machine";
            collectorComponent.push(machineInfo);
            var brandInfo = {};
            brandInfo.ComponentType="textfield";
            brandInfo.ComponentName = "Brand";
            collectorComponent.push(brandInfo);
             var prodtechInfo = {};
            prodtechInfo.ComponentType="textfield";
            prodtechInfo.ComponentName = "Prodtech";
            collectorComponent.push(prodtechInfo);
            // var foremanInfo = {};
            //foremanInfo.ComponentType="textfield";
            //foremanInfo.ComponentName = "Foreman";
            //collectorComponent.push(foremanInfo);
            var mekanikInfo = {};
            mekanikInfo.ComponentType="textfield";
            mekanikInfo.ComponentName = "Mekanik";
            collectorComponent.push(mekanikInfo);
            var elektrikInfo = {};
            elektrikInfo.ComponentType="textfield";
            elektrikInfo.ComponentName = "Elektrik";
            collectorComponent.push(elektrikInfo);
            var teamLeaderInfo = {};
            teamLeaderInfo.ComponentType="textfield";
            teamLeaderInfo.ComponentName = "TeamLeader";
            collectorComponent.push(teamLeaderInfo);
            var poNumberInfo = {};
            poNumberInfo.ComponentType="textfield";
            poNumberInfo.ComponentName = "PONumber";
            collectorComponent.push(poNumberInfo);
            var shiftInfo = {};
            shiftInfo.ComponentType="textfield";
            shiftInfo.ComponentName = "Shift";
            collectorComponent.push(shiftInfo);
               var groupInfo = {};
            groupInfo.ComponentType="textfield";
            groupInfo.ComponentName = "Group";
            collectorComponent.push(groupInfo);
            var startInfo = {};
            startInfo.ComponentType="textfield";
            startInfo.ComponentName = "Start";
            collectorComponent.push(startInfo);
            var stopInfo = {};
            stopInfo.ComponentType="textfield";
            stopInfo.ComponentName = "Stop";
            collectorComponent.push(stopInfo);


        }
            function collectProductInfoComponent() {

                var lastStockSlof = {};
                lastStockSlof.ComponentType="textfield";
                lastStockSlof.ComponentName = "LastStockSlof";
                collectorComponent.push(lastStockSlof);

                var lastStockTB = {};
                lastStockTB.ComponentType="textfield";
                lastStockTB.ComponentName = "LastStockTB";
                collectorComponent.push(lastStockTB);

                var lastStockZB = {};
                lastStockZB.ComponentType="textfield";
                lastStockZB.ComponentName = "LastStockZB";
                collectorComponent.push(lastStockZB);
                   //-----
                var reworkSlof = {};
                reworkSlof.ComponentType="textfield";
                reworkSlof.ComponentName = "ReworkSlof";
                collectorComponent.push(reworkSlof);

                var reworkTB = {};
                reworkTB.ComponentType="textfield";
                reworkTB.ComponentName = "ReworkTB";
                collectorComponent.push(reworkTB);

                var reworkZB = {};
                reworkZB.ComponentType="textfield";
                reworkZB.ComponentName = "ReworkZB";
                collectorComponent.push(reworkZB);
                //-----
                var qcSlof = {};
                qcSlof.ComponentType="textfield";
                qcSlof.ComponentName = "QCSlof";
                collectorComponent.push(qcSlof);

                var qcTB = {};
                qcTB.ComponentType="textfield";
                qcTB.ComponentName = "QCTB";
                collectorComponent.push(qcTB);

                var qcZB = {};
                qcZB.ComponentType="textfield";
                qcZB.ComponentName = "QCZB";
                collectorComponent.push(qcZB);
                //-----
                var initialSlof = {};
                initialSlof.ComponentType="textfield";
                initialSlof.ComponentName = "InitialSlof";
                collectorComponent.push(initialSlof);

                var initialTB = {};
                initialTB.ComponentType="textfield";
                initialTB.ComponentName = "InitialTB";
                collectorComponent.push(initialTB);

                var initialZB = {};
                initialZB.ComponentType="textfield";
                initialZB.ComponentName = "InitialZB";
                collectorComponent.push(initialZB);
                //-----
                var resultProduct = {};
                resultProduct.ComponentType="textfield";
                resultProduct.ComponentName = "ResultProduct";
                collectorComponent.push(resultProduct);

                var inputTray = {};
                inputTray.ComponentType="textfield";
                inputTray.ComponentName = "InputTray";
                collectorComponent.push(inputTray);
            }
            function collectLemComponent() {
            var lemPack = {};
            lemPack.ComponentType="textfield";
            lemPack.ComponentName = "LemPack";
            collectorComponent.push(lemPack);

            var lemBandrol = {};
            lemBandrol.ComponentType="textfield";
            lemBandrol.ComponentName = "LemBandrol";
            collectorComponent.push(lemBandrol);
        }
            function collectDataAfkirComponent() {
            var cigarRejectAfkir = {};
            cigarRejectAfkir.ComponentType="textfield";
            cigarRejectAfkir.ComponentName = "CigarRejectAfkir";
            collectorComponent.push(cigarRejectAfkir);

            var etiketAfkir = {};
            etiketAfkir.ComponentType="textfield";
            etiketAfkir.ComponentName = "EtiketAfkir";
            collectorComponent.push(etiketAfkir);

             var afkirBlank1 = {};
            afkirBlank1.ComponentType="textfield";
            afkirBlank1.ComponentName = "AfkirBlank1";
            collectorComponent.push(afkirBlank1);

            var afkirBlank2 = {};
            afkirBlank2.ComponentType="textfield";
            afkirBlank2.ComponentName = "AfkirBlank2";
            collectorComponent.push(afkirBlank2);
        }
            function collectBandrolInfoComponent() {

                var acceptBandrol = {};
                acceptBandrol.ComponentType="textfield";
                acceptBandrol.ComponentName = "BandrolAccept";
                collectorComponent.push(acceptBandrol);

                var useBandrol = {};
                useBandrol.ComponentType="textfield";
                useBandrol.ComponentName = "BandrolUse";
                collectorComponent.push(useBandrol);

                var rejectBandrol = {};
                rejectBandrol.ComponentType="textfield";
                rejectBandrol.ComponentName = "BandrolRejected";
                collectorComponent.push(rejectBandrol);

                var finalBandrol = {};
                finalBandrol.ComponentType="textfield";
                finalBandrol.ComponentName = "BandrolFinal";
                collectorComponent.push(finalBandrol);
                //------
                 var packUseBandrol = {};
                packUseBandrol.ComponentType="textfield";
                packUseBandrol.ComponentName = "BandrolPackUse";
                collectorComponent.push(packUseBandrol);

                var destroyBandrol = {};
                destroyBandrol.ComponentType="textfield";
                destroyBandrol.ComponentName = "BandrolDestroy";
                collectorComponent.push(destroyBandrol);

                var claimBandrol = {};
                claimBandrol.ComponentType="textfield";
                claimBandrol.ComponentName = "BandrolClaim";
                collectorComponent.push(claimBandrol);

                var ipcBandrol = {};
                ipcBandrol.ComponentType="textfield";
                ipcBandrol.ComponentName = "BandrolIPC";
                collectorComponent.push(ipcBandrol);

            }
            function collectProductionResultComponent() {
                var resultPack = {};
                resultPack.ComponentType="textfield";
                resultPack.ComponentName = "ResultPack";
                collectorComponent.push(resultPack);

                var resultBox = {};
                resultBox.ComponentType="textfield";
                resultBox.ComponentName = "ResultBox";
                collectorComponent.push(resultBox);

            }

        // Part Collect Value
            function collectInformationValue() {
            var dateInfoValue = {};
            dateInfoValue.Value= $('#txtDateInfo').val();
            dateInfoValue.ValueType = "NonNumeric";
            collectorValue.push(dateInfoValue);
            var weekInfoValue = {};
            weekInfoValue.Value= $('#txtWeekNumber').val();
            weekInfoValue.ValueType = "Numeric";
            collectorValue.push(weekInfoValue);
            var machineInfoValue = {};
            machineInfoValue.Value= $('#machInfo').val();
            machineInfoValue.ValueType = "NonNumeric";
            collectorValue.push(machineInfoValue);
            var brandInfoValue = {};
            brandInfoValue.Value= $('#brandInfo').val();
            brandInfoValue.ValueType = "NonNumeric";
            collectorValue.push(brandInfoValue);
            var prodTechInfoValue = {};
            var tem_value = $('#prodTech').val();
            if (Array.isArray(tem_value)) {
	            tem_value = tem_value.join('___');
            }
            prodTechInfoValue.Value = tem_value;
            prodTechInfoValue.ValueType = "NonNumeric";
            collectorValue.push(prodTechInfoValue);
            //var foremanInfoValue = {};
            //foremanInfoValue.Value= $('#foreman').val();
            //foremanInfoValue.ValueType = "NonNumeric";
            //collectorValue.push(foremanInfoValue);
            var mekanikInfoValue = {};
            mekanikInfoValue.Value= $('#mekanik').val();
            mekanikInfoValue.ValueType = "NonNumeric";
            collectorValue.push(mekanikInfoValue);
            var elektrikInfoValue = {};
            elektrikInfoValue.Value= $('#elektrik').val();
            elektrikInfoValue.ValueType = "NonNumeric";
            collectorValue.push(elektrikInfoValue);
            var teamLeaderInfoValue = {};
            teamLeaderInfoValue.Value= $('#teamLeader').val();
            teamLeaderInfoValue.ValueType = "NonNumeric";
            collectorValue.push(teamLeaderInfoValue);
            var poNumberInfoValue = {};
            poNumberInfoValue.Value= $('#PONumber').val();
            poNumberInfoValue.ValueType = "NonNumeric";
            collectorValue.push(poNumberInfoValue);
            var shiftInfoValue = {};
            shiftInfoValue.Value= $('#shift').val();
            shiftInfoValue.ValueType = "NonNumeric";
            collectorValue.push(shiftInfoValue);
            var groupInfoValue = {};
            groupInfoValue.Value= $('#group').val();
            groupInfoValue.ValueType = "NonNumeric";
            collectorValue.push(groupInfoValue);
            var startInfoValue = {};
            startInfoValue.Value= $('#inputTimeStart').val();
            startInfoValue.ValueType = "Numeric";
            collectorValue.push(startInfoValue);
            var stopInfoValue = {};
            stopInfoValue.Value= $('#inputTimeStop').val();
            stopInfoValue.ValueType = "Numeric";
            collectorValue.push(stopInfoValue);
        }
            function collectProductInfoValue() {

             var lastStockSlofValue = {};
                lastStockSlofValue.Value= $('#LastStockSlof').val();
                lastStockSlofValue.ValueType = "Numeric";
                collectorValue.push(lastStockSlofValue);

                var lastStockTBValue = {};
                lastStockTBValue.Value= $('#LastStockTB').val();
                lastStockTBValue.ValueType = "Numeric";
                collectorValue.push(lastStockTBValue);

                var lastStockZBValue = {};
                lastStockZBValue.Value= $('#LastStockZB').val();
                lastStockZBValue.ValueType = "Numeric";
                collectorValue.push(lastStockZBValue);

                //-----
                var reworkSlofValue = {};
                reworkSlofValue.Value= $('#ReworkSlof').val();
                reworkSlofValue.ValueType = "Numeric";
                collectorValue.push(reworkSlofValue);

                var reworkTBValue = {};
                reworkTBValue.Value= $('#ReworkTB').val();
                reworkTBValue.ValueType = "Numeric";
                collectorValue.push(reworkTBValue);

                var reworkZBValue = {};
                reworkZBValue.Value= $('#ReworkZB').val();
                reworkZBValue.ValueType = "Numeric";
                collectorValue.push(reworkZBValue);
                //-----
                var qcSlofValue = {};
                qcSlofValue.Value= $('#QCSlof').val();
                qcSlofValue.ValueType = "Numeric";
                collectorValue.push(qcSlofValue);

                var qcTBValue = {};
                qcTBValue.Value= $('#QCTB').val();
                qcTBValue.ValueType = "Numeric";
                collectorValue.push(qcTBValue);

                var qcZBValue = {};
                qcZBValue.Value= $('#QCZB').val();
                qcZBValue.ValueType = "Numeric";
                collectorValue.push(qcZBValue);
                //-----
                var initialSlofValue = {};
                initialSlofValue.Value= $('#InitialSlof').val();
                initialSlofValue.ValueType = "Numeric";
                collectorValue.push(initialSlofValue);

                var initialTBValue = {};
                initialTBValue.Value= $('#InitialTB').val();
                initialTBValue.ValueType = "Numeric";
                collectorValue.push(initialTBValue);

                var initialZBValue = {};
                initialZBValue.Value= $('#InitialZB').val();
                initialZBValue.ValueType = "Numeric";
                collectorValue.push(initialZBValue);
                //-----
                var resultProductValue = {};
                resultProductValue.Value= $('#ResultProduct').val();
                resultProductValue.ValueType = "Numeric";
                collectorValue.push(resultProductValue);

                var inputTrayValue = {};
                inputTrayValue.Value= $('#InputTray').val();
                inputTrayValue.ValueType = "Numeric";
                collectorValue.push(inputTrayValue);
        }
            function collectLemValue() {
                var lemPackValue = {};
                lemPackValue.Value= $('#LemPack').val();
                lemPackValue.ValueType = "NonNumeric";
                collectorValue.push(lemPackValue);
                var lemBandrolValue = {};
                lemBandrolValue.Value= $('#LemBandrol').val();
                lemBandrolValue.ValueType = "NonNumeric";
                collectorValue.push(lemBandrolValue);
            }
            function collectDataAfkirValue() {
                var cigarRejectAfkirValue = {};
                cigarRejectAfkirValue.Value= $('#CigarRejectAfkir').val();
                cigarRejectAfkirValue.ValueType = "NonNumeric";
                collectorValue.push(cigarRejectAfkirValue);

                var etiketAfkirValue = {};
                etiketAfkirValue.Value= $('#EtiketAfkir').val();
                etiketAfkirValue.ValueType = "Numeric";
                collectorValue.push(etiketAfkirValue);

                var afkirBlank1Value = {};
                afkirBlank1Value.Value= $('#AfkirBlank1').val();
                afkirBlank1Value.ValueType = "Numeric";
                collectorValue.push(afkirBlank1Value);

                 var afkirBlank2Value = {};
                afkirBlank2Value.Value= $('#AfkirBlank2').val();
                afkirBlank2Value.ValueType = "Numeric";
                collectorValue.push(afkirBlank2Value);
            }
            function collectBandrolInfoValue() {

                var acceptBandrolValue = {};
                acceptBandrolValue.Value=$('#BandrolAccept').val();
                acceptBandrolValue.ValueType = "Numeric";
                collectorValue.push(acceptBandrolValue);

                var useBandrolValue = {};
                useBandrolValue.Value=$('#BandrolUse').val();
                useBandrolValue.ValueType = "Numeric";
                collectorValue.push(useBandrolValue);

                var rejectBandrolValue = {};
                rejectBandrolValue.Value=$('#BandrolRejected').val();
                rejectBandrolValue.ValueType = "Numeric";
                collectorValue.push(rejectBandrolValue);

                var finalBandrolValue = {};
                finalBandrolValue.Value=$('#BandrolFinal').val();
                finalBandrolValue.ValueType = "Numeric";
                collectorValue.push(finalBandrolValue);
                //------
                 var packUseBandrolValue = {};
                packUseBandrolValue.Value=$('#BandrolPackUse').val();
                packUseBandrolValue.ValueType ="Numeric";
                collectorValue.push(packUseBandrolValue);

                var destroyBandrolValue = {};
                destroyBandrolValue.Value=$('#BandrolDestroy').val();
                destroyBandrolValue.ValueType = "Numeric";
                collectorValue.push(destroyBandrolValue);

                var claimBandrolValue = {};
                claimBandrolValue.Value=$('#BandrolClaim').val();
                claimBandrolValue.ValueType ="Numeric";
                collectorValue.push(claimBandrolValue);

               var ipcBandrolValue = {};
               ipcBandrolValue.Value =$('#BandrolIPC').val();
                ipcBandrolValue.ValueType = "Numeric";
                collectorValue.push(ipcBandrolValue);

            }
            function collectProductResultValue() {
            var valuePack = {};
            valuePack.Value=$('#ResultPack').val();
            valuePack.ValueType = "Numeric";
            collectorValue.push(valuePack);

            var valueBox = {};
            valueBox.Value=$('#ResultBox').val();
            valueBox.ValueType = "Numeric";
            collectorValue.push(valueBox);

        }

		    var LPHID = 0;
            var timerID;

            function checkMandatory() {
                var mandatory = $(".mandatory");
                const headerHeight = $(".navbar.navbar-header.navbar-header-fixed").outerHeight();
                var status = true;
                for (var i = 0; i < mandatory.length; i++) {
                    if (($(mandatory[i])[0].nodeName.toLowerCase() === 'select') && $(mandatory[i])[0].value === "") {
                        window.scrollTo(0, Math.max(0, $(mandatory[i]).offset().top - headerHeight- 100));
                        $(mandatory[i]).siblings(".select2-container").css('border', '1px solid red');
                        $(mandatory[i]).siblings(".select2-container").css('border-radius', '0.25rem');
                        $(mandatory[i]).parent().prepend($('<span>', {
                            style: "color:red; display:block; float:left;",
                            id: "mandatory-error-" + i,
                            html: '!',
                            class: 'row'
                        }));
                        $(mandatory[i]).on('select2:select', function (e) {
                            $(e.target).siblings(".select2-container").css('border', 'none');
                            $(e.target).siblings(".select2-container").css('border-radius', '0');
                            $(e.target).parent().find('span.row').remove();
                        });
                        status = false;
                    } else if ($(mandatory[i])[0].value === "") {
                        window.scrollTo(0, Math.max(0, $(mandatory[i]).offset().top - headerHeight- 100));
                        $(mandatory[i])[0].style.borderColor = "red";
                        $(mandatory[i]).parent().prepend($('<span>', {
                            style: "color:red; display:block; float:left;",
                            id: "mandatory-error-" + i,
                            html: '!',
                            class: 'row'
                        }));
                        $(mandatory[i]).on('click', function (e) {
                            e.target.style.borderColor = "rgb(192, 204, 218)";
                            $(e.target).parent().find('span.row').remove();
                        });
                        $(mandatory[i]).on('focus', function (e) {
                            e.target.style.borderColor = "rgb(192, 204, 218)";
                            $(e.target).parent().find('span.row').remove();
                        });
                        status = false;
                    }
                }
                return status;
            }

        function saveLPH(url, isSubmit) {
              if (isSubmit == 1)
                clearInterval(timerID);

              collectorComponent = [];
              collectorValue = [];
              var timeStart = $('#inputTimeStart').val();
              var timeStop = $('#inputTimeStop').val();

              var collectorArray = []; // for LPH Extras

              var collectorArray = collectAllData(); // for LPH Extras

              var detailSubmission = {};
              detailSubmission.StartTime = timeStart;
              detailSubmission.EndTime = timeStop;
              detailSubmission.Shift = $('#shift').val();

              collectInformationComponent();
              collectProductInfoComponent();
              collectLemComponent();
              collectDataAfkirComponent();
              collectBandrolInfoComponent();
              collectProductionResultComponent();

              collectInformationValue();
              collectProductInfoValue();
              collectLemValue();
              collectDataAfkirValue();
              collectBandrolInfoValue();
              collectProductResultValue();

             $.ajax({
                  type: "POST",
                  url: url,
                    data: JSON.stringify({
                      // chanif: tambah LPHID supaya bisa pakai fungsi edit. tambah isSubmit untuk membedakan submit sama autosave
                      id: LPHID,
                      isSubmit: isSubmit,

                      detailExtras: collectorArray,
                      detailSubmission: detailSubmission,
                      detailComponent: collectorComponent,
                      detailValue: collectorValue
                  }),
                  contentType: "application/json; charset=utf-8",
                  dataType: "json",
                 success: function (result) {
                      if (isSubmit == 1) {
					        if (result.Status == 'True') {
						        var notice = new PNotify({
							        title: "@UIResources.Confirmation",
							        text: "@UIResources.CreateSucceed",
							        width: "400px",
							        type: 'success',
							        addclass: 'stack-bottomright'
						        });

						        notice.get().click(function () {
							        notice.remove();
                                });

                                //window.location = window.location.href.split("?")[0];
                                window.location.href = "@(Url.Action("Index", "History"))";
					        }
					        else {
						        var notice = new PNotify({
							        title: "@UIResources.ErrorMessage",
							        text: "@UIResources.CreateFailed",
							        width: "400px",
                                    type: 'error',
                                    addclass: 'stack-bottomright',
							        hide: false,
							        buttons: {
								        sticker: false
							        }
						        });

						        notice.get().click(function () {
								        notice.remove();
							        });
						        }
                      } else {
                          if (result.Status == 'True') {
                              if (typeof result.LPHID === 'undefined') {
                                      console.log("edit done");
                                          var notice = new PNotify({
							                title: "@UIResources.Confirmation",
							                text: "@UIResources.EditSucceed",
							                width: "400px",
							                type: 'success',
							                addclass: 'stack-bottomright'
						                });

                                      setTimeout(function(){
                                            notice.remove();
                                        }, 3000);
                                  } else {
                                      console.log("create done");
                                      $('#btnSave').removeClass('d-none');
                                      $('#btnReset').removeClass('d-none');
                                      LPHID = result.LPHID;
                                      console.log(LPHID);
                                      var notice = new PNotify({
							                title: "@UIResources.Confirmation",
							                text: "@UIResources.CreateSucceed",
							                width: "400px",
							                type: 'success',
							                addclass: 'stack-bottomright'
						                });

                                      setTimeout(function(){
                                            notice.remove();
                                        }, 3000);
                                  }
                          }
                          else {

                              // chanif: tetap munculkan error kalau gagal save ketika autosave
						        var notice = new PNotify({
							        title: "@UIResources.ErrorMessage",
							        text: "@UIResources.CreateFailed",
							        width: "400px",
                                    type: 'error',
                                    addclass: 'stack-bottomright',
							        hide: false,
							        buttons: {
								        sticker: false
							        }
						        });

						        notice.get().click(function () {
								        notice.remove();
							        });
						        }
                            }
                      },
                      error: function (request, status, error) {
                            window.location.reload(true);
                      },
                        complete: function() {
                            $('#loading_overlay').addClass('d-none');
                        },
                });

        }
            $(window).load(function()
            {
                submission = JSON.parse($("#submission").attr("data-json"));
                console.log(submission);
                if (submission) {
                    if ($('#oneday').val() == '1') {
                        window.location.replace("@(Url.Action("Edit", "CigarilloPacker"))?lphid=" + submission.LPHID);
                    } else {
                        $('#submission-modal').modal({ backdrop: 'static', keyboard: false });
                        $('#submission_employee').html($('#employee_id').val());
                        $('#submission_employee_name').html($('#employee_name').val());
                        $('#submission_date').html(moment(submission.ModifiedDate).format("DD-MMM-YY hh:ss"));
                        $('#submission-modal').modal('show');
                    }

                } else {
                    saveLPH("@Url.Action("Create", "CigarilloPacker")", 0);
                    // chanif: lalu autosave tiap 3 menit
                    setInterval(function () {
                        $('#loading_overlay').removeClass('d-none');
                        saveLPH("@Url.Action("Edit", "CigarilloPacker")", 0);
                    }, 10 * 60 * 1000);
                }


            });

            $("#submission-modal .reset").click(function () {
                DeleteLPH(submission.LPHID);
            });
            $("#submission-modal .continue").click(function () {
                window.location.replace("@(Url.Action("Edit", "CigarilloPacker"))?lphid=" + submission.LPHID);
            });
        @*$(window).load(function ()
        {
            console.log("la");
            saveLPH("@Url.Action("Create", "CigarilloPacker")", 0);

            // chanif: lalu autosave tiap 3 menit
            setInterval(function () {
                saveLPH("@Url.Action("Edit", "CigarilloPacker")", 0);
            }, 10 * 60 * 1000);
        });*@
        $('#goPrev').click(function () {
            $.ajax({
                type: "POST",
                url: "@Url.Action("CheckPrev", "CigarilloPacker")",
                data: JSON.stringify({
                    LPHID: LPHID,
					machine: $('#machInfo').val()
                }),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (result) {
				if (result.Status) {
					//ketika data ada, munculkan dalam window baru
                    window.open("@(Url.Action("Submitted", "CigarilloPacker"))?lphid="+result.LPHID+"&type=1", "window baru", "height=400,width=1300");
				}
				else {
					var notice = new PNotify({
						title: "@UIResources.ErrorMessage",
						text: "No previous submissions found",
						width: "400px",
                        type: 'error',
                        addclass: 'stack-bottomright',
						hide: false,
						buttons: {
							sticker: false
						}
					});

					notice.get().click(function () {
							notice.remove();
						});
					}
                }
            });
        })
        $('#btnSave').click(function () {
            if (checkMandatory()) {
                $('#loading_overlay').removeClass('d-none');
                saveLPH("@Url.Action("Edit", "CigarilloPacker")", 1);
            }
            else {
                var notice = new PNotify({
						title: "Warning",
						text: "Submit failed, input field with red border, and photo can't be empty",
						width: "400px",
                        type: 'error',
                        addclass: 'stack-bottomright',
						hide: false,
						buttons: {
							sticker: false
						}
                });
                setTimeout(function(){
                        notice.remove();
                }, 8000);
            }
        });
        $('#btnSaveDraft').click(function () {
            $('#loading_overlay').removeClass('d-none');
            saveLPH("@Url.Action("Edit", "CigarilloPacker")", 0);
        });
        $('#btnReset').click(function () {
                var redirect = confirm("All unsubmitted changes will be lost. Do you really want to reset?");
                if (redirect) {
                    @*window.location.href = "@(Url.Action("Index", "CigarilloPacker"))/?reset=true";*@
                    DeleteLPH(LPHID);
                }
            });


            function DeleteLPH(Id) {
                $('#loading_overlay').removeClass('d-none');
                $.ajax({
                    url: fastApp.BaseUrl + '/History/Delete?lphid=' + Id,
                    type: 'POST',
                    success: function (result) {
                        if (result.Status) {
                            var notice = new PNotify({
                            title: "@UIResources.Confirmation",
                            text: 'Reset LPH Successfully',
                            width: "400px",
                            type: 'success',
                            addclass: 'stack-bottomright'
                            });

                            notice.get().click(function () {
                                notice.remove();
                            });
                        }
                        else {
                            var notice = new PNotify({
                                title: "@UIResources.ErrorMessage",
                                text: "@UIResources.DeleteFailed",
                                width: "400px",
                                type: 'error',
                                hide: false,
                                addclass: 'stack-bottomright',
                                buttons: {
                                    sticker: false
                                }
                            });

                            notice.get().click(function () {
                                notice.remove();
                            });
                        }
                        $('#loading_overlay').addClass('d-none');
                    },
                    complete: function (data) {
                        $('#loading_overlay').addClass('d-none');
                        setTimeout(function () {
                            window.location.href = "@(Url.Action("Index", "CigarilloPacker"))";
                        }, 1000);
                    }
                });
            }
        });
        function basicFunction() {

            /*  chanif: $('.select2').start diganti jadi $('.select2').select2 */
            $('.select2').select2({
		        allowClear: true,
                placeholder: 'Choose one',
                searchInputPlaceholder: 'Search options'
            });
            $('#prodTech').select2('destroy');
            $('#prodTech').select2({
	            placeholder: 'Choose one or more',
	            searchInputPlaceholder: 'Search options'
            });

            $(document).find('.input-time').each(function () {
                var cleave = new Cleave($(this), {
                    time: true,
                    timePattern: ['h', 'm']
                });
            })
        }
        function ieFix() {
            if (navigator.userAgent.search("Edge") >= 0) {
                $(".tableWrapper:has(tfoot)").each(function () {
                    $(this).find("tfoot tr.input").css({ "position": "fixed", "bottom": "-0.5px" });
                    $(this).find("table").css({ "margin-bottom": "32px" });
                    $(this).css({ "overflow-y": "scroll" });
                    const ths = $(this).find("thead tr:first-child th");
                    $(this).find("tfoot td").each(function (i) {
                        $(this).css({ "min-width": $($(ths)[i]).width() + 20, "position": "static" });
                    });
                });
            }
        }
        function uuidv4() {
            return ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, c =>
                (c ^ crypto.getRandomValues(new Uint8Array(1))[0] & 15 >> c / 4).toString(16));
        }

        function generateRow(data, targetTable) {
            let r = "";
            $(`#${targetTable} ~ tfoot tr.input td`).children("input, select").each(function () {
                const name = $(this).prop("name");
                r += `<td data-name="${name}">${data[name]}</td>`;
            });

            let useEdit = true;
            let useDelete = true;
            let additionalButtons = "";
            if (configAle[targetTable].rowConfig !== undefined) {
                if (configAle[targetTable].rowConfig.withEdit !== undefined)
                    useEdit = configAle[targetTable].rowConfig.withEdit;
                if (configAle[targetTable].rowConfig.withDelete !== undefined)
                    useDelete = configAle[targetTable].rowConfig.withDelete;
                if (configAle[targetTable].rowConfig.additionalButtons != undefined)
                    additionalButtons = configAle[targetTable].rowConfig.additionalButtons(data);
            }
            r += `<td class="tx-center">`;
            r += additionalButtons;
            if (useEdit) r += `<i onclick="javascript:editData(this)" data-id="${data.id}" data-target-table="${targetTable}" class="fa fa-edit edit"></i>`;
            if (useDelete) r += `<span onClick="javascript:deleteData(this)" data-id="${data.id}" data-target-table="${targetTable}"><i class="fa fa-trash"></i></span>`;
            r += `</td >`;
            return r;
        }
        function generateTable(arr, targetTable) {
            if (arr.length == 0) return "";
            let rows = "";
            for (var i = arr.length - 1; i >= 0; i--) {
                rows += '<tr>';
                rows += generateRow(arr[i], targetTable);
                rows += '</tr>';
            }
            return rows;
        }
        function findInArray(id, crr) {
            for (var i = 0; i < crr.length; i++) {
                if (crr[i].id == id) {
                    return i;
                }
            }
        }
        function deleteFromArray(id, crr) {
            crr.splice(findInArray(id, crr), 1);
            return crr;
        }
        function editData(button) {
            const table = $(button).parents("table");
            if (!$(table).data("edited")) {
                $(table).data("edited", true);

                const tds = $(button).parents("tr").children('td');
                const inputTr = $(table).find('tr.input');
                const inputTds = $(inputTr).children('td');
                const tdsCount = $(tds).length;

                $(tds).each(function (i, e) {
                    const el = $(inputTds[i]).children()[0];
                    if (i != tdsCount - 1) {
                        const html = $(e).html();
                        const newInput = $(el).clone();
                        if (!$(el).hasClass("disabled"))
                            $(newInput).prop("disabled", false);

                        $(el).prop("disabled", true);
                        $(newInput).val(html);
                        $(e).html(newInput);
                    } else {
                        $(el).off("click");
                        const edit = $(e).find(".edit");
                        $(edit).attr("onclick", "javascript:normalData(this)");
                        $(edit).removeClass("fa-edit");
                        $(edit).addClass("fa-save");
                    }
                });
            }
            $('.date').toArray().forEach(function (field) {
                new Cleave(field, {
                    time: true,
                    timePattern: ['h', 'm']
                });
            });
            ieFix();
        }
        function releaseDisabledInput(table) {
            $(table).data("edited", false);
            const tds = $(table).find('tr.input td');
            const tdsCount = $(tds).length;
            $(tds).each(function (i, e) {
                const el = $(e).children()[0];
                if (i != tdsCount - 1) {
                    if (!$(el).hasClass("disabled"))
                        $(el).prop("disabled", false);
                } else {
                    var ev = $._data(el, 'events');
                    if (!(ev && ev.click))
                        $(el).on("click", addToTable);
                }
            });
        }
        function wizardButtonSetSelection(button) {
            selected = $(button).html();
            wizardButtonNext(button);
        }
        function wizardButtonNext(button) {
            const modal = $(button).parents(".modal");
            const carousel = $(modal).find('.carousel');
            const index = $(carousel).find('.carousel-item.active').index();
            const stepper = $(modal).find('.stepper');

            var info = { shouldReturn: false, shouldHide: false };
            $(modal).trigger("next", [index, info]);
            if (info.shouldReturn) return;
            if (info.shouldHide) { $(modal).modal('hide'); return; }

            $(stepper).children('.active').removeClass("active");

            $(carousel).carousel('next');
            $(stepper).children(`.stepper-step:nth-child(${index + 2})`).toggleClass("active");
            $(modal).find(".prev").show();
        };
        function generateWizardButton(arr) {
            let r = "";
            for (var i = 0; i < arr.length; i++) {
                r += `<button type="button" class="wizard-button btn btn-primary" onclick="javascript:wizardButtonSetSelection(this)">${arr[i]}</button>`;
            }
            return r;
        }
        function startupSetup(target, data) {
            $(target).html(generateTable(data, target));
            countSummary(target);
        }
        $(document).ready(function () {
            $("#iconSave").hide();
            $('.date').toArray().forEach(function (field) {
                new Cleave(field, {
                    time: true,
                    timePattern: ['h', 'm']
                });
            });
            $(".add-to-table").on("click", addToTable);
            $('.tableWrapper thead tr').each(function () {
                const top = $(this).position().top;
                $(this).children().css({ "top": top });
            });
            $(".wizard-modal .next").click(wizardButtonNext);
            $(".wizard-modal .prev").click(function () {
                const modal = $(this).parents(".modal");
                const carousel = $(modal).find('.carousel');
                const stepper = $(modal).find('.stepper');
                const index = $(carousel).find('.carousel-item.active').index();

                $(stepper).children('.active').removeClass("active");

                $(carousel).carousel('prev');
                $(stepper).children(`.stepper-step:nth-child(${index})`).toggleClass("active");
                if (index == 1) $(modal).find(".prev").hide();
            });
            $('.wizard-modal').on('hidden.bs.modal', function (e) {
                const carousel = $(this).find('.carousel');
                const stepper = $(this).find('.stepper');
                $(this).find('.active').removeClass("active");
                $(stepper).children(".stepper-step:first-child").toggleClass("active");
                $(carousel).find(".carousel-item:first-child").toggleClass("active");
                $(this).trigger("hide");
                $(this).find(".prev").hide();
            });

        });
        function addToTable(button) {
            const targetTable = $(this).data("target");
            const tds = $(this).parents("tr").children("td");
            var newdata = {
                id: uuidv4()
            };
            let shouldReturn = false;
            $(tds).each(function (tdIndex, td) {
                const input = $(td).children();
                if (input.attr("name") != undefined) {
                    const name = input.attr("name");
                    const val = input.val();
                    if (configAle[targetTable].onValidate != undefined) {
                        if (configAle[targetTable].onValidate(name, val)) {
                            shouldReturn = true;
                            if ((input[0].nodeName.toLowerCase() === 'select')) {
                                $(input[0]).siblings(".select2-container").css('border', '1px solid red');
                                $(input[0]).siblings(".select2-container").css('border-radius', '0.25rem');
                                $(input[0]).on('select2:select', function (e) {
                                    $(input[0]).siblings(".select2-container").css('border', 'none');
                                    $(input[0]).siblings(".select2-container").css('border-radius', '0');
                                });
                            } else if (input[0].value === "") {
                                input[0].style.borderColor = "red";
                                $(input[0]).on('click', function (e) {
                                    input[0].style.borderColor = "rgb(192, 204, 218)";
                                });
                            }
                            return false;
                        }
                    }
                    if (input[0].type.toLowerCase() == "number") {
                        var myRegexp = /^00+$/g;
                        var match = myRegexp.exec(val);
                        if (match != null) {
                            alert("Please input a valid number");
                            shouldReturn = true;
                            return false;
                        }
                    }
                    newdata[name] = val;
                }
            });
            if (shouldReturn) return;
            $(tds).each(function (i, td) {
                const node = $(td).children();
                $(node).val("");
                if ($(node).hasClass("select2"))
                    $(node).trigger('change');
            });

            if (configAle[targetTable].onAdd != undefined) {
                if (configAle[targetTable].onAdd(newdata)) {
                    return;
                }
            }
            configAle[targetTable].data.push(newdata);
            $("#" + targetTable).html(generateTable(configAle[targetTable].data, targetTable));
            countSummary(targetTable);
            ieFix();
        }
        function countSummary(targetTable) {
            if (configAle[targetTable].countSummary != undefined) {
                const rowData = configAle[targetTable].countSummary();
                const summaryTds = $('#' + targetTable).parents('table').find('.summary-body').children();
                $('#' + targetTable).parents('table').find('.input td').each(function (i, td) {
                    const name = $(td).children().attr("name");
                    if (rowData.hasOwnProperty(name))
                        $(summaryTds[i]).html(rowData[name]);
                });
            }
        }
        function deleteData(button) {
            if (confirm("Are you sure?")) {
                const id = $(button).data("id");
                const targetTable = $(button).data("target-table");
                const table = $(button).parents("table");
                releaseDisabledInput(table);
                if (configAle[targetTable].onDelete != undefined) {
                    if (configAle[targetTable].onDelete(id)) {
                        return;
                    }
                }
                deleteFromArray(id, configAle[targetTable].data);
                $('#' + targetTable).html(generateTable(configAle[targetTable].data, targetTable));
                countSummary(targetTable);
                ieFix();
            }
        }
        function normalData(button) {
            if (confirm("Are you sure?")) {
                const id = $(button).data("id");
                const targetTable = $(button).data("target-table");
                const tds = $(button).parents("tr").children('td');
                const tdsCount = $(tds).length;
                const table = $(button).parents("table");

                if (configAle[targetTable].onSave != undefined) {
                    if (configAle[targetTable].onSave(id)) {
                        return;
                    }
                }
                const index = findInArray(id, configAle[targetTable].data);
                let shouldReturn = false;
                var newdata = {
                    id: uuidv4()
                };
                $(tds).each(function (tdIndex, e) {
                    if (tdIndex != tdsCount - 1) {
                        const name = $(e).data("name");
                        const val = $($(e).children()[0]).val();
                        if (configAle[targetTable].onValidate != undefined) {
                            if (configAle[targetTable].onValidate(name, val)) {
                                shouldReturn = true;
                                return false;
                            }
                        }
                        newdata[name] = val;
                    } else {
                        const edit = $(e).find(".edit");
                        $(edit).attr("onclick", "javascript:editData(this)");
                        $(edit).removeClass("fa-save");
                        $(edit).addClass("fa-edit");
                    }
                });
                if (shouldReturn) return;

                configAle[targetTable].data[index] = newdata;
                const row = generateRow(configAle[targetTable].data[index], targetTable);
                $(button).parents("tr").html(row);

                releaseDisabledInput(table);
                countSummary(targetTable);
                ieFix();
            }
        }
        function collectAllData() {
            let collectorArray = [];
            for (var tableId in configAle) {
                let tableColumnType = {};
                $(`#${tableId} ~ tfoot tr.input td input`).each(function () {
                    tableColumnType[$(this).prop("name")] = $(this).prop("type");
                });
                const data = configAle[tableId].data;
                for (let i = 0; i < data.length; i++) {
                    for (var prop in data[i]) {
                        if (Object.prototype.hasOwnProperty.call(data[i], prop)) {
                            if (prop == "id") continue;
                            let val = data[i][prop];
                            if (configAle[tableId].onCollectData != undefined) {
                                val = configAle[tableId].onCollectData(prop, val);
                            }
                            console.log(prop, val);
                            collectorArray.push({
                                HeaderName: tableId,
                                FieldName: prop,
                                Value: val,
                                ValueType: tableColumnType[prop] == "number" ? "Numeric" : "NonNumeric",
                                RowNumber: i
                            });
                            console.log(collectorArray);
                        }
                    }
                }
            }
            return collectorArray;
        }
        function countDuration(start, end, duration) {
            var end = $('#' + end).val();
            var start = $('#' + start).val();

            if (start != "" && end != "") {
                end = end.split(':');
                start = start.split(':');
                var d = new Date();
                var startdate = new Date(d.getFullYear(), d.getMonth(), d.getDate(), start[0], start[1]);
                var enddate = new Date(d.getFullYear(), d.getMonth(), d.getDate(), end[0], end[1]);

                if (startdate > enddate) {
                    enddate = new Date(enddate);
                    enddate.setDate(enddate.getDate() + 1);
                }

                var diffTime = enddate - startdate;
                var diffMinutes = Math.ceil(diffTime / 60000);
                if (diffMinutes == NaN) {
                    $('#' + duration).val(0);
                } else {
                    $('#' + duration).val(diffMinutes);
                }
            }
        };</script>
    <script>
        /*
             * name = id dari tbody;
             * data = array untuk menyimpan data;
             * countSummary = dipanggil saat menghitung summary, return object dengan property sesuai dengan name pada `tfoot tr.input`;
             * onAdd(newData) = dipanggil sebelum menambah data, return boolean apakah harus ditambahkan atau tidak;
             * onDelete(idOfDeletedObject) = dipanggil sebelum menghapus data, return boolean apakah harus dihapus atau tidak;
             * onSave(idOfUpdatedObject) = dipanggil sebelum mengubah data, return boolean apakah harus diubah atau tidak;
             * onValidate(nameOfInput, valueOfInput) = validasi nilai saat tambah dan save, return boolean apakah harus diterus atau tidak;
             *
             * rowConfig = config untuk generate baris tabel;
             * - withEdit = menampilkan edit, default true;
             * - withDelete = menampilkan delete, default true;
             * - additionalButtons(data) = fungsi untuk yang akan mengembalikan button tambahan untuk tiap baris, return element html dalam string;
             */

        var bandrolData = [];
        var logbookData = [];
        var actionData = [];
        const configAle = {
            bandroltake: {
                data: bandrolData,
                countSummary: function () {
                    let rowData = {};
                    let take = 0;
                    let weight = 0;
                    for (var i = 0; i < bandrolData.length; i++) {
                        weight += parseInt(bandrolData[i].weight);
                    }
                    for (var i = 0; i < bandrolData.length; i++) {
                        take += parseInt(bandrolData[i].take);
                    }
                    rowData.take = take;
                    rowData.weight = weight;//+ " pcs";

                    $('#BandrolAccept').val(rowData.weight);
                    countUse();
                    return rowData;
                },
            },
            logbook: {
                data: logbookData,
                onValidate(name, val) {
                    if (val == "") {
                        alert("Value can't be empty");
                        return true;
                    }
                    return false;
                },
                onAdd: function (newData) {
                    console.log(newData);
                },
            },
            action: {
                data: actionData,
                onValidate(name, val) {
                    if (val == "") {
                        alert("Value can't be empty");
                        return true;
                    }
                    return false;
                },
                countSummary: function () {
                    let rowData = {};
                    let NextDurasi = 0;
                    for (var i = 0; i < actionData.length; i++) {
                        NextDurasi += parseInt(actionData[i].NextDurasi);
                    }
                    rowData.NextDurasi = NextDurasi;
                    return rowData;
                },
                onAdd: function (newData) {
                    console.log(newData);
                },
            },
        }

    </script>
    <script>


        // ----- Collect Data (Component, Value, Approval, Extras) & Save Process




    </script>



    <script>

        var isUrlLink = null;
        @*var img1Content, img2Content, img3Content = "";*@
        @*var isImg1, isImg2, isImg3 = false;*@
      //  var isImg = [];@*[false,false,false];*@
       // var imgContent = []; @*["","",""];*@
        var img1Content, img2Content, img3Content,img4Content, img5Content = "";
        var isImg1, isImg2, isImg3, isImg4, isImg5 = false;

        var imageIndex = 0;
        var max = 5;


        var selected = null;


        function defaultDisplay() {
            //for (var i = 0; i < max; i++) {
            //    $("#image_"+(i+1)+"_show").hide();
            //    $("#image_"+(i+1)+"_hide").show();
            //}
              $("#image_1_show").hide();
            $("#image_1_hide").show();

            $("#image_2_show").hide();
            $("#image_2_hide").show();

            $("#image_3_show").hide();
            $("#image_3_hide").show();

             $("#image_4_show").hide();
            $("#image_4_hide").show();

            $("#image_5_show").hide();
            $("#image_5_hide").show();
        }

        function switchDisplay() {
            //for (var i = 0; i < max; i++) {
            //    if (isImg[i] == true) {
            //        $("#image_"+(i+1)+"_show").show();
            //        $("#image_"+(i+1)+"_hide").hide();
            //    }
            //}
             if (isImg1 == true) {
                $("#image_1_show").show();
                $("#image_1_hide").hide();
            }
            if (isImg2 == true) {
                $("#image_2_show").show();
                $("#image_2_hide").hide();
            }
            if (isImg3 == true) {
                $("#image_3_show").show();
                $("#image_3_hide").hide();
            }
             if (isImg4 == true) {
                $("#image_4_show").show();
                $("#image_4_hide").hide();
            }
             if (isImg5 == true) {
                $("#image_5_show").show();
                $("#image_5_hide").hide();
            }
        }


        function infoId(e) {
            for (var i = 0; i < max; i++) {
                if (e.id == "image_"+(i+1)+"") {
                    isImg[i] = true;
                }else{
                    isImg[i] = false;
                }
            }

        }

        function renderImage(link, state) {

            if (link == null || link == "") {
                isUrlLink = false;
            }
            else {

                isUrlLink = true;
                console.log("link " + link);
                console.log("state: " + state);

                //for (var i = 0; i < max; i++) {
                //    if (state == "image_'"+(i+1)+"'") {
                //        imgContent[i] = link;
                //        document.getElementById("image_'"+(i+1)+"'_show").innerHTML = '<img class="input-img rounded mx-auto d-block" src=' + imgContent[i] + ' id="image_'+(i+1)+'"  width="160px" data-toggle="modal" data-target="#photo-modal" />';
                //    }
                //}
                if (state == "image_1") {
                    img1Content = link;
                    document.getElementById("image_1_show").innerHTML = '<img class="input-img rounded mx-auto d-block" src=' + img1Content + ' id="image_1" width="160px" data-toggle="modal" data-target="#photo-modal" />';
                }
                if (state == "image_2") {
                    img2Content = link;
                    document.getElementById("image_2_show").innerHTML = '<img class="input-img rounded mx-auto d-block" src=' + img2Content + ' id="image_2" width="160px" data-toggle="modal" data-target="#photo-modal" />';
                }
                if (state == "image_3") {
                    img3Content = link;
                    document.getElementById("image_3_show").innerHTML = '<img class="input-img rounded mx-auto d-block" src=' + img3Content + ' id="image_3" width="160px" data-toggle="modal" data-target="#photo-modal" />';
                }
                  if (state == "image_4") {
                    img4Content = link;
                    document.getElementById("image_4_show").innerHTML = '<img class="input-img rounded mx-auto d-block" src=' + img4Content + ' id="image_4" width="160px" data-toggle="modal" data-target="#photo-modal" />';
                }
                if (state == "image_5") {
                    img5Content = link;
                    document.getElementById("image_5_show").innerHTML = '<img class="input-img rounded mx-auto d-block" src=' + img5Content + ' id="image_5" width="160px" data-toggle="modal" data-target="#photo-modal" />';
                }
            }
        }

        $("#t_splacing").click(function () {
            isImg1 = true;
            isImg2 = false;
            isImg3 = false;
            isImg4 = false;
            isImg5 = false;
        });

        $("#t_innerframe").click(function () {
             isImg1 = false;
            isImg2 = true;
            isImg3 = false;
            isImg4 = false;
            isImg5 = false;
        });

        $("#t_endlabel").click(function () {
            isImg1 = false;
            isImg2 = false;
            isImg3 = true;
            isImg4 = false;
            isImg5 = false;
        });
        $("#t_alufoil").click(function () {
            isImg1 = false;
            isImg2 = false;
            isImg3 = false;
            isImg4 = true;
            isImg5 = false;
        });

        $("#t_intiket").click(function () {
            isImg1 = false;
            isImg2 = false;
            isImg3 = false;
            isImg4 = false;
            isImg5 = true;
        });

        $(document).ready(function () {
            defaultDisplay();

            $("#photo-modal").on('next', function (e, index, info) {
                if (!selected) {
                    info.shouldReturn = true;
                    return;
                }
                console.log(index)
                switch (index) {
                    case 0:
                        const carousel = $(this).find('.carousel-item.active').next();
                        $(carousel).find("#title").html("Take picture for " + selected);
                        $(this).find(".next").show();
                        selectedPhotoCategory = selected;
                        break;
                    case 1:
                        info.shouldHide = true;
                        if (isUrlLink == true) switchDisplay();
                        else defaultDisplay();
                        break;
                }
            });
            $('#photo-modal').on('hide', function (e) {
                $(this).find(".next").hide();
                selected = null;
            });

        });
    </script>

    <script>
        $("#machInfo").on('select2:select', function (e) {
            console.log(e.params.data);
            var shift = $("#shift").val();
            $.ajax({
                type: "POST",
                url: "@Url.Action("GetLastStock", "CigarilloPacker")",
                data: JSON.stringify({
                    machine: e.params.data.text
                }),
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (result) {
                    console.log(result.Status);
                    if (result.Status == 'True') {
                        $('#InitialSlof').val(result.slof);
                        $('#InitialZB').val(result.zb);
                    } else {
                        $('#InitialSlof').val(0);
                        $('#InitialZB').val(0);
                    }
                }
            });
        });
        function countUse() {
            var accept = $('#BandrolAccept').val() != "" ? $('#BandrolAccept').val() : 0;
            var reject = $('#BandrolRejected').val() != "" ? $('#BandrolRejected').val() : 0;
            var final = $('#BandrolFinal').val() != "" ? $('#BandrolFinal').val() : 0;
            var destroy = $('#BandrolDestroy').val() != "" ? $('#BandrolDestroy').val() : 0;
            var claim = $('#BandrolClaim').val() != "" ? $('#BandrolClaim').val() : 0;
            var ipc = $('#BandrolIPC').val() != "" ? $('#BandrolIPC').val() : 0;

            var use = accept - reject - final - destroy - claim - ipc;
            $('#BandrolUse').val(use);

            countLose()
        };

        function countLose() {
            var packResult = $('#ResultPack').val();
            var useBandrol = $('#BandrolUse').val();

            if (packResult != "" && useBandrol != "") {

                var lost = packResult - useBandrol;
                $('#BandrolPackUse').val(lost);
            }
        };
        $('#ResultPack').focusout(function () {
            countLose();
            $('#ResultProduct').val($('#ResultPack').val())
        });

        $('#BandrolAccept').focusout(function () {
            countUse();
        });

        $('#BandrolRejected').focusout(function () {
            countUse();
        });

        $('#BandrolFinal').focusout(function () {
            countUse();
        });

        $('#BandrolDestroy').focusout(function () {
            countUse();
        });

        $('#BandrolClaim').focusout(function () {
            countUse();
        });

        $('#BandrolIPC').focusout(function () {
            countUse();
        });
    </script>
    <script>
        function countResProduct() {
            var initialSlof = $('#InitialSlof').val() != "" ? $('#InitialSlof').val() : 0;
            var initialTB = $('#InitialTB').val() != "" ? $('#InitialTB').val() : 0;

            var reworkSlof = $('#ReworkSlof').val() != "" ? $('#ReworkSlof').val() : 0;
            var reworkTB = $('#ReworkTB').val() != "" ? $('#ReworkTB').val() : 0;

            var qcSlof = $('#QCSlof').val() != "" ? $('#QCSlof').val() : 0;
            var qcTB = $('#QCTB').val() != "" ? $('#QCTB').val() : 0;

            var lastSlof = $('#LastStockSlof').val() != "" ? $('#LastStockSlof').val() : 0;
            var lastTB = $('#LastStockTB').val() != "" ? $('#LastStockTB').val() : 0;

            var boxRes = $('#ResultBox').val() != "" ? $('#ResultBox').val() : 0;

            var brandRes = $('#brandInfo option:selected').text();
            var brandVal = $('#brandInfo').val(); // faCode

            //temporary use 10 , waiting for confirmation
            var resProduct = (parseInt(lastSlof * 10) + parseInt(lastTB)) + (parseInt(qcSlof * 10) + parseInt(qcTB)) - (parseInt(reworkSlof * 10) + parseInt(reworkTB)) - (parseInt(initialSlof * 10) + parseInt(initialTB));
            $('#ResultProduct').val(resProduct);

            var amountPackBox = 0;
            if (boxRes > 0 && brandRes != "") {
                //need check brand for amountPackBox
                if (brandVal == "FC100365.07" || brandVal == "FC100365.10") {
                    amountPackBox = 250;
                    var resProductWithBox = resProduct + parseInt(boxRes * amountPackBox);
                    $('#ResultPack').val(resProductWithBox);
                }
                else {
                    amountPackBox = 500;
                    var resProductWithBox = resProduct + parseInt(boxRes * amountPackBox);
                    $('#ResultPack').val(resProductWithBox);

                }

            }


        }

        $('#InitialSlof').focusout(function () {
            countResProduct();
        });
        $('#InitialTB').focusout(function () {
            countResProduct();
        });
        $('#ReworkTB').focusout(function () {
            countResProduct();
        });
        $('#ReworkSlof').focusout(function () {
            countResProduct();
        });
        $('#QCTB').focusout(function () {
            countResProduct();
        });
        $('#QCSlof').focusout(function () {
            countResProduct();
        });
        $('#LastStockSlof').focusout(function () {
            countResProduct();
        });
        $('#LastStockTB').focusout(function () {
            countResProduct();
        });
        $('#ResultBox').focusout(function () {
            countResProduct();
        });
        function editInitialStock() {
            $("#iconSave").show();
            $("#iconEdit").hide();
            $('#InitialSlof').attr("disabled", false);
            $('#InitialTB').attr("disabled", false);
            $('#InitialZB').attr("disabled", false);
        }
        function disabledInitialStock() {
            $("#iconSave").hide();
            $("#iconEdit").show();
            $('#InitialSlof').attr("disabled", true);
            $('#InitialTB').attr("disabled", true);
            $('#InitialZB').attr("disabled", true);
        }
    </script>
    <script>
        $("#hideHandover").click(function () {
            var x = document.getElementById("multicollapse");
            if (x.style.display === 'none') {
                x.style.display = '';
                $("#hideHandover").html("<i class='fas fa-eye-slash'></i> Hide");
            } else {
                x.style.display = 'none';
                $("#hideHandover").html("<i class='fas fa-eye'></i> Show");
            }
        });
    </script>
    <script>
        function detectBrowser() {
            var ua = navigator.userAgent, tem,
                M = ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i) || [];
            if (/trident/i.test(M[1])) {
                tem = /\brv[ :]+(\d+)/g.exec(ua) || [];
                return 'IE ' + (tem[1] || '');
            }
            if (M[1] === 'Chrome') {
                tem = ua.match(/\b(OPR|Edge)\/(\d+)/);
                if (tem != null) return tem.slice(1).join(' ').replace('OPR', 'Opera');
            }
            M = M[2] ? [M[1], M[2]] : [navigator.appName, navigator.appVersion, '-?'];
            if ((tem = ua.match(/version\/(\d+)/i)) != null) M.splice(1, 1, tem[1]);
            return M.join(' ');
        };
        if (detectBrowser().indexOf("Chrome") < 0) {
            $('input[type=number]').toArray().forEach(function (field) {
                $(field).attr("placeholder", "0");
                new Cleave(field, {
                    numeral: true,
                    numeralDecimalScale: 2,
                    numeralThousandsGroupStyle: 'none',
                    //numeralDecimalMark: ',',
                    //delimiter: '.',
                    numeralPositiveOnly: $(field).hasClass("number-positive"),
                });
                $(field).on("keyup", function (e) {
                    if (e.keyCode == 190) {
                        let val = $(this).val();
                        const i = val.lastIndexOf(".");
                        let a = val.length > 1 ? val.substring(i - 1, i) : "-";
                        if (isNaN(a)) $(this).val(val.slice(0, i) + "0.");
                    }
                });
            });
        }
    </script>
}